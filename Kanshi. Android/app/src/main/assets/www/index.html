<!DOCTYPE html>
<html lang="en" class="darkMode noscroll">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanshi. - Anime Recommendation</title>
    <link rel="shortcut icon" type="image/x-icon" href="./public/logo.png" />
    <!-- Jquery -->
    <script src="./js-css/jquery-3.6.0.js" defer></script>
    <!-- Swal 2 -->
    <link rel="preload" href="./js-css/swal2/sweetalert2.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="./js-css/swal2/sweetalert2.css"></noscript>
    <script src="./js-css/swal2/sweetalert2.all.js" defer></script>
    <!-- Table Sort -->
    <link rel="preload" href="./js-css/jquery tablesorter/theme.default.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="./js-css/jquery tablesorter/theme.default.min.css"></noscript>
    <script type="text/javascript" src="./js-css/jquery tablesorter/jquery.tablesorter.js" defer></script>
    <script type="text/javascript" src="./js-css/jquery tablesorter/jquery.metadata.min.js" defer></script>
    <script type="text/javascript" src="./js-css/jquery tablesorter/jquery.tablesorter.pager.min.js" defer></script>
    <!-- Datalist Search Code -->
    <link rel="preload" href="./js-css/flexdatalist/jquery.flex-datalist-v1.0.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="./js-css/flexdatalist/jquery.flex-datalist-v1.0.css"></noscript>
    <script src="./js-css/flexdatalist/jquery.flex-datalist-v1.7.js" defer></script>
    <!-- Bootstrap -->
    <link rel="preload" href="./js-css/bootstrap-3.3.8.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="./js-css/bootstrap-3.3.8.min.css"></noscript>
    <!-- Fontawesome -->
    <link rel="preload" href="./js-css/font-awesome.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="./js-css/font-awesome.min.css"></noscript>
    <script src="./js-css/fontawesome-5.0.js" crossorigin="anonymous" defer></script>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-PPMY92TJCE" defer></script>
    <script defer>
        window.onload = () => {
            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'G-PPMY92TJCE');
        }
    </script>
    <style>
            /* Change For Text Size */
            :root{
                font-size: 0.9rem !important;
            }
            /* Change/Add to Class/Tag of desired division for Padding */
            #Home,
            #overlay{
                padding-inline: clamp(0px, 5vw, 75px) !important;
            }
            /* Default */
            html,
            body {
                min-height: 100%;
                width: 100%;
                overflow: auto;
            }
            :root{
                font-size: 0.9rem;
                background-color: #F0F0F0;
                font-family: sans-serif;
                z-index: 0;
                min-width: 100%;
                min-height: 100%;
                overflow:auto;
            }
            :root>*{
                background-color: #F0F0F0;
                min-width: inherit;
                min-height: inherit;
            }
            *,
            ::after,
            ::before{
                margin: 0;
                padding: 0;
                text-indent: 0;
                box-sizing: border-box;
            }
            /* Text */
            .textLogo{
                font-size: clamp(1.6rem, 2vw,1.6rem) !important;
            }
            h1{
                font-size: clamp(1.3rem, 2vw,1.3rem);
            }
            h2{
                font-size: clamp(1.05rem, 2vw,1.05rem);
            }
            h3{
                font-size: clamp(1.05rem, 2vw,1.05rem);
            }
            p,
            label,
            input[type="text"]{
                font-size: clamp(0.95rem, 2vw,0.95rem);
            }
            h4{
                font-size: clamp(1rem, 2vw,1rem);
            }
            h5{
                font-size: clamp(0.9rem, 2vw,0.9rem);
            }
            h6{
                font-size: clamp(0.8rem, 2vw,0.8rem);
            }
            h1,
            h2,
            h3,
            h4,
            h5,
            h6,
            p,
            input,
            textarea,
            .textLogo{
                cursor:default;
                -webkit-hyphens:manual;
                hyphens:manual;
                white-space:pre-wrap;
                word-break:break-word;
                overflow-wrap:break-word;
                transform-origin: left;
            }
            h1,
            h2,
            h3,
            h4,
            h5,
            h6,
            p,
            .textLogo{
                max-width: -moz-fit-content;
                min-width: -moz-fit-content;
                min-width: -webkit-fill-available;
                max-width: fit-content;
                min-width: fit-content;
            }
            /* Forms */
            input,
            textarea{
                outline: 0;
            }
            input[type=text]{
                -ms-user-select: text;
                -webkit-user-select: text;
                user-select: text;
            }
            button,
            button>*{
                cursor: pointer;
            }
            dialog{
                border: 0;
            }
            img{
                max-width: 100%;
            }
            .noscroll{
                overflow: hidden !important;
            }
            /* Additional */
            *{
                scrollbar-width: none !important;
            }
            body{
                -ms-overflow-style: none;
            }
            ::-webkit-scrollbar {
                display: none;
            }
            .example {
                -ms-overflow-style: none;
                scrollbar-width: none;
            }
            button,
            .swal2-confirm {
                background-color: #57728e !important;
                color: #F0F0F0;
            }
            button.hide-anime,
            button.show-anime{
                box-shadow: none !important;
            }
            .swal2-deny,
            .swal2-deny-custom{
                background-color: #e27d81 !important;
            }
            .swal2-popup,
            .swal2-popup-custom{
                background-color: #F0F0F0 !important;
            }
            input {
                padding: 0.5em;
            }
            #username {
                width: min-content;
                max-width: 100%;
                border-color: rgb(118, 118, 118);
                border-width: 2px;
                border-style: inset;
                border-radius: 0px;
                background-color: rgb(255, 255, 255);
                cursor: text !important;
            }
            #loader {
                position: fixed;
                left: 0px;
                top: 0px;
                width: 100%;
                height: 100%;
                z-index: 9999;
                background: url('./public/loading.gif')
                    50% 50% no-repeat
                    rgb(0, 0, 0);
            }
            #loader > * {
                justify-content: center;
                min-height: 100%;
                align-items: center;
                display: flex;
                margin-top: 150px;
                color: wheat;
                text-align: center;
            }
            #loaderText{
                user-select: none;
            }
            label{margin: 0}
            #searchData,
            #table-responsive{
                margin-top: 15px;
                margin-bottom: 15px;
            }
            #searchData,
            .btn-container{
                margin-bottom: 10px !important;
            }
            #table-responsive{
                margin-top: 10px !important;
                background-color: inherit !important;
                border: none !important;
            }
            .flexdatalist-multiple > .value {
                height: fit-content;
                max-height: fit-content;
                min-height: fit-content;
                max-width: -moz-fit-content;
                max-width: fit-content;
                cursor: pointer;
            }
            #userInputContainer,
            .filter-container,
            .btn-container{
                display: flex;
                flex-wrap: wrap;
                justify-content: center;
                align-items: center;
                margin-block: 15px;
            }
            #userInputContainer>:not(label),
            .filter-container>:not(label),
            .btn-container>:not(label){
                flex-grow: 1;
            }
            .flex0.flexdatalist-multiple{
                display: flex;
                max-height: 100px;
                min-height: 100px;
                height: 100px;
                overflow-y: scroll;
            }
            .flex1.flexdatalist-multiple,
            .flex2.flexdatalist-multiple{
                display: flex;
                max-height: 175px;
                min-height: 175px;
                height: 175px;
                overflow-y: scroll;
            }
            .flex0.flexdatalist-multiple{
                flex-wrap: wrap;
            }
            .flex1.flexdatalist-multiple,
            .flex2.flexdatalist-multiple{
                flex-wrap: wrap-reverse;
            }
            .flexdatalist-multiple-value{
                flex-grow: 1;
                display: flex !important;
                min-width: calc(100% - 10px) !important;
            }
            .flexdatalist-alias{
                outline: none;
                flex-grow: 1;
                padding-left: 5px !important;
                padding-right: 5px !important;
                cursor: text !important;
            }
            .tableLoadingContainer{
                display: flex;
                justify-content: center;
                align-items: center;
            }
            .show-hidden-anime-btn{
                text-align: center !important;
                min-width: 85px !important;
            }
            #header {
                background: url('./public/header.png');
                background-color: white;
                right: 0;
                width: 100%;
                height: 165px;
                background-repeat: no-repeat;
                background-position: right;
                background-size: contain;
                position: relative;
                overflow: hidden;
                border-radius: 0 0 50% 50% / 5%;
            }
            #overlay{
                width: 100%;
                height: 100%;
                padding: 1.75em;
                color: #FFF;
                background-image: linear-gradient( 135deg, #2B2D426b 10%, #2B2D426b 100%);
                user-select: none;
            }
            #overlay>*{
                padding-right: 50%;
            }
            button {
                border: none;
                outline: none;
                padding: 10px 20px;
                border-radius: 50px;
                box-shadow: 0 3px 20px 0 #0000003b;
            }
            button:hover{
                cursor: pointer;
            }
            a,
            a:hover,
            a:focus {
                color: #005580;
            }
            .display-none{
                display: none !important;
            }
            .anime-table-headers{
                outline: none;
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
            }
            #anime-table,
            #anime-table>thead,
            .anime-table-headers,
            #animeRecommendationList,
            #animeRecommendationList>.item{
                border: none !important;
            }
            #animeRecommendationList td{
                border-top: 0px solid #E5E5E5 !important;
                border-bottom: 1px solid #E5E5E5 !important;
                border-left: 1px solid #E5E5E5 !important;
                border-right: 1px solid #E5E5E5 !important;
            }
            #animeRecommendationList{
                content-visibility: auto;
            }
            #updateIntervalBtn,
            #showAllAnime{
                display: none;
            }
            #hiddenUnhiddenBtn{
                background: #57728e !important;
                color: #F0F0F0 !important;
                max-width: -moz-fit-content !important;
                max-width: fit-content !important;
                cursor: pointer;
            }
            #searchBtn:hover,
            #searchBtn:focus{
                color: #F0F0F0;
            }
            .tablesorter-header{
                vertical-align: middle !important;
                padding: 1em !important;
            }
            .tablesorter-header-inner{
                margin-right: 0.5em !important;
                min-width: max-content !important;
            }
            .show-all-anime{
                background: black !important;
                color: #F0F0F0 !important;
                border-radius: 5%;
                max-width: -moz-fit-content !important;
                max-width: fit-content !important;
            }
            .tablesorter-default{
                margin: 0 !important;
            }
            .hide-anime-column{
                padding-block: 1.5em !important;
                vertical-align: middle !important;
                text-align: center !important;
                -ms-user-select: none !important;
                -webkit-user-select: none !important;
                user-select: none !important;
            }
            #animeRecommendationList>.item,
            .flexdatalist-multiple,
            .flexdatalist-alias,
            #userInputContainer,
            #username{
                background-color: #f4f4f4 !important;
            }
            #anime-table,
            #anime-table > thead,
            .tablesorter-header,
            .anime-table-headers,
            #animeRecommendationList,
            #animeRecommendationList>.item,
            #animeRecommendationList>.item>td,
            .td-container,
            .table-skeleton td{
                background-color: #fafafa !important;
            }
            .anime-table-headers,
            .anime-table-headers > th,
            .table-skeleton th{
                background-color: #e7e7e7 !important;
            }            
            .flexdatalist-multiple>.value{
                /* Android */
                user-select: none !important;
                /* Android */
                background-color: #e7e7e7 !important;
            }
            .user-select-all{
                user-select: all !important;
            }
            #animeRecommendationList > .item > td {
                vertical-align: middle !important;
                /* Android */
                user-select: none !important;
                /* Android */
            }
            .anime-score{
                text-align: center !important;
                max-width: 50px !important;
                text-overflow: ellipsis !important;
                overflow: hidden !important;
            }
            .pointer{
                cursor: pointer !important;
            }
            .anime-score > div {
                display: flex;
                gap: 0.5ch;
                max-width: 50px !important;
                text-overflow: ellipsis !important;
                overflow: scroll !important;
            }
            .spinner {
                border: 2px solid #f3f3f3;
                border-top: 2px solid #005885;
                border-radius: 50%;
                width: 13px;
                min-width: 13px;
                height: 13px;
                min-height: 13px;
                animation: spin 2s linear infinite;
            }
            @keyframes spin {
                0% { transform: rotate(0deg); }
                100% { transform: rotate(360deg); }
            }
            .data-status-container{
                display: flex;
                align-items: center;
                justify-content: center;
            }
            #table-responsive{
                min-height: 556px !important;
                margin-bottom: 100px !important;
            }
            .pager{
                position: fixed;
                bottom: 0;
                width: 100%;
                border-radius: 50% 50% 0 0 / 5%;
                background: rgb(43, 45, 66,0.925);
                color: #F0F0F0;
                margin: 0;
                z-index: 100;
            }
            .pager-form{
                display: flex;
                justify-content: center;
                align-items: center;
                -ms-user-select: none;
                -webkit-user-select: none;
                user-select: none;
            }
            #first,
            #prev,
            #next,
            #last,
            #selectPageNumber{
                flex: 1;
                min-width: -moz-fit-content;
                min-width: -webkit-fill-available;
                min-width: fit-content;
                display: flex;
                justify-content: center;
                align-items: center;
                cursor: pointer;
            }
            .pager-form>div>*{
                flex: 1;
                min-width: -moz-fit-content;
                min-width: -webkit-fill-available;
                min-width: fit-content;
                cursor: pointer;
            }
            #pager {
                padding: 1em;
            }
            #first.disabled,
            #prev.disabled,
            #next.disabled,
            #last.disabled{
                opacity: 0.5;
                filter: alpha(opacity=50);
                cursor: default;
            }
            #pageNumberOptions{
                margin: 0;
                padding: 0;
                height: -webkit-fill-available;
                height: fit-content;
                border: transparent;
                text-align: center;
                outline: none;
                -webkit-appearance: none;
                -moz-appearance: none;
                appearance: none;
                background-color: transparent !important;
            }
            #pageNumberOptions>option{
                background-color: #2b2d42;
                color: #F0F0F0;
            }
            #nav{
                z-index: 100;
                position: fixed;
                width: 100%;
                height: 50px;
                display: flex;
                color: #F0F0F0;
                justify-content: space-between;
                background-color: rgb(43, 45, 66,0.925);
                padding: 1em;
                align-items: center;
                -ms-user-select: none;
                -webkit-user-select: none;
                user-select: none;
            }
            #nav > div{
                flex: 1;
                display: flex;
            }
            #menuIcon{
                margin-left: auto;
                max-height: 40px;
                cursor: pointer;
            }
            #menuTitle{
                cursor: pointer;
            }
            #header{
                margin-top: 50px;
            }
            #menu-container {
                overflow: auto;
                top: 0px;
                right: 0;
                position: fixed;
                z-index: 99;
                height: 100%;
                width: 100%;
                background-color: rgb(0, 0, 0, 0.925);
                color: #F0F0F0;
                display: none;
                -ms-user-select: none;
                -webkit-user-select: none;
                user-select: none;
                overscroll-behavior: contain
            }
            #menu-container>div{
                padding-bottom: 79px;
                padding-top: 66px;
                padding-left: 1em;
                padding-right: 1em;
                display: flex;
                flex-wrap: wrap;
                gap: 1.5em;
                height: min-content;
            }
            #menu-container>div>button{
                -moz-box-shadow: 0 3px 20px 0 #2B2D42 !important;
                -webkit-box-shadow: 0 3px 20px 0 #2B2D42 !important;
                box-shadow: 0 3px 20px 0 #2B2D42 !important;
            }
            .no-before::before{
                content: none;
            }
            .whitespace-pre-wrap{
                white-space: pre-wrap !important;
            }
            .swal2-container{
                overscroll-behavior: contain;
                -ms-user-select: none;
                -webkit-user-select: none;
                user-select: none;
            }
            .swal2-validation-message{
                color: black !important;
            }
            .swal2-validation-message.no-before::before{
                content: none;
            }
            .swal2-validation-message.error-before::before {
                content: "!";
                display: inline-block;
                width: 1.5em;
                min-width: 1.5em;
                height: 1.5em;
                margin: 0 0.625em;
                border-radius: 50%;
                background-color: #f27474;
                color: #fff;
                font-weight: 600;
                line-height: 1.5em;
                text-align: center;
            }
            .swal2-validation-message.success-before::before {
                content: "✓";
                display: inline-block;
                width: 1.5em;
                min-width: 1.5em;
                height: 1.5em;
                margin: 0 0.625em;
                border-radius: 50%;
                background-color: #78f274;
                color: #fff;
                font-weight: 600;
                line-height: 1.5em;
                text-align: center;
            }
            .swal2-actions{
                justify-content: space-evenly !important;
                width: 100% !important;
                gap: 1em !important;
                padding-inline: 1em !important;
            }
            .swal2-actions button{
                min-width: -moz-fit-content !important;
                min-width: -webkit-fill-available !important;
                min-width: fit-content !important;
                flex:1 !important;
            }
            .swal2-footer{
                justify-content: space-evenly !important;
                width: 100% !important;
                flex-wrap: wrap;
                gap: 1.5ch;
            }
            .no-border{
                border: none !important;
            }
            .swal2-footer > *{
                flex: 1 !important;
                min-width: 100% !important;
                text-align: center !important;
            }
            .swal-overlay-custom{
                display: none;
                position: fixed;
                top: 0;
                bottom: 0;
                left: 0;
                right: 0;
                text-align: center;
                font-size: 0;
                overflow-y: auto;
                background-color: rgba(0,0,0,.4);
                z-index: 10000;
                pointer-events: none;
                opacity: 0;
                transition: opacity .3s;
            }
            .swal-overlay--show-modal-custom{
                opacity: 1;
                pointer-events: auto;
            }
            .swal-overlay--show-modal-custom .swal-modal-custom{
                opacity: 1;
                pointer-events: auto;
                box-sizing: border-box;
                -webkit-animation: showSweetAlert .3s;
                animation: showSweetAlert .3s;
                will-change: transform;
            }
            @keyframes swal2-show-custom {
                0% {
                    transform: scale(0.7);
                }
                45% {
                    transform: scale(1.05);
                }
                80% {
                    transform: scale(0.95);
                }
                100% {
                    transform: scale(1);
                }
            }
            @keyframes swal2-hide-custom {
                0% {
                    transform: scale(1);
                    opacity: 1;
                }
                100% {
                    transform: scale(0.5);
                    opacity: 0;
                }
            }
            .swal2-show-custom {
                animation: swal2-show 0.3s;
            }
            .swal2-hide-custom {
                animation: swal2-hide 0.15s forwards;
            }
            .swal2-container-custom.swal2-top-custom,
            .swal2-container-custom.swal2-center-custom,
            .swal2-container-custom.swal2-bottom-custom {
                grid-template-columns: auto minmax(0, 1fr) auto;
            }
            .swal2-container-custom.swal2-backdrop-show-custom,
            .swal2-container-custom.swal2-noanimation-custom {
                background: rgba(0, 0, 0, 0.4);
            }
            [class^=swal2] {
                -webkit-tap-highlight-color: transparent;
            }
            .swal2-container-custom {
                display: grid;
                position: fixed;
                z-index: 1060;
                top: 0;
                right: 0;
                bottom: 0;
                left: 0;
                box-sizing: border-box;
                grid-template-areas:
                    "top-start top top-end"
                    "center-start center center-end"
                    "bottom-start bottom-center bottom-end";
                grid-template-rows: minmax(min-content, auto) minmax(min-content, auto) minmax(min-content, auto);
                height: 100%;
                padding: 0.625em;
                overflow-x: hidden;
                transition: background-color 0.1s;
                -webkit-overflow-scrolling: touch;
            }
            .swal2-container-custom.swal2-center-custom > .swal2-popup-custom {
                grid-column: 2;
                grid-row: 2;
                align-self: center;
                justify-self: center;
            }
            .swal2-show-custom {
                animation-duration: 0.3s;
                animation-timing-function: ease;
                animation-delay: 0s;
                animation-iteration-count: 1;
                animation-direction: normal;
                animation-fill-mode: none;
                animation-play-state: running;
                animation-name: swal2-show;
            }
            .swal2-show-custom {
                animation: swal2-show 0.3s;
            }
            .swal2-popup-custom {
                display: none;
                position: relative;
                box-sizing: border-box;
                grid-template-columns: minmax(0, 100%);
                width: 32em;
                max-width: 100%;
                padding: 0 0 1.25em;
                border: none;
                border-radius: 5px;
                background: #fff;
                color: #545454;
                font-family: inherit;
                font-size: 1rem;
            }
            .swal2-html-container-custom {
                z-index: 1;
                justify-content: center;
                margin: 1em 1.6em 0.3em;
                padding: 0;
                overflow: auto;
                color: inherit;
                font-size: 1.125em;
                font-weight: normal;
                line-height: normal;
                text-align: center;
                word-wrap: break-word;
                word-break: break-word;
            }
            .swal2-actions-custom {
                display: flex;
                z-index: 0;
                box-sizing: border-box;
                flex-wrap: wrap;
                align-items: center;
                justify-content: center;
                width: auto;
                margin: 1.25em auto 0;
                padding: 0;
            }
            .swal2-actions-custom {
                justify-content: space-evenly !important;
                width: 100% !important;
                gap: 1em !important;
                padding-inline: 1em !important;
            }
            .swal2-styled-custom.swal2-deny-custom {
                border: 0;
                border-radius: 0.25em;
                background: initial;
                background-color: #dc3741;
                color: #fff;
                font-size: 1em;
            }
            .swal2-styled-custom.swal2-confirm-custom {
                border: 0;
                border-radius: 0.25em;
                background: initial;
                background-color: #7066e0;
                color: #fff;
                font-size: 1em;
            }
            .swal2-styled-custom:not([disabled]) {
                cursor: pointer;
            }
            .swal2-actions-custom button {
                min-width: -mozfit-content !important;
                min-width: -webkit-fill-available !important;
                min-width: fit-content !important;
                flex: 1 !important;
            }
            .swal2-styled-custom {
                margin: 0.3125em;
                padding: 0.625em 1.1em;
                transition: box-shadow 0.1s;
                box-shadow: 0 0 0 3px transparent;
                font-weight: 500;
            }
            .swal2-timer-progress-bar-container-custom {
                position: absolute;
                right: 0;
                bottom: 0;
                left: 0;
                grid-column: auto !important;
                overflow: hidden;
                border-bottom-right-radius: 5px;
                border-bottom-left-radius: 5px;
            }
            button.selected{
                background-color: #F0F0F0 !important;
                color: black !important;
            }
            /* Dark Mode */
            html.darkMode,
            body.darkMode,
            #Home.darkMode,
            #searchData.darkMode,
            #dataStatusHolder.darkMode{
                background-color: rgb(11,22,34) !important;
                color: rgb(185, 202, 221) !important
            }
            #overlay.darkMode{
                width: 100%;
                height: 100%;
                padding: 1.75em;
                color: #FFF;
                background-image: linear-gradient( 135deg, #39343c69 10%, #151F2E6b 100%) !important;
            }
            #overlay.darkMode{
                color: rgb(214 233 255) !important;
            }
            #searchBtn.darkMode,
            #hiddenUnhiddenBtn.darkMode,
            #menu-container>div>button.darkMode,
            .hide-anime-column button.darkMode,
            .swal2-confirm.darkMode,
            .swal2-confirm-custom.darkMode{
                background-color: rgb(40 69 102) !important;
                color: rgb(185, 202, 221) !important;
            }
            #menu-container>div>button.selected.darkMode{
                background-color: black !important;
                color: rgb(185, 202, 221) !important;
            }
            #username.darkMode,
            #anime-table.darkMode,
            #animeRecommendationList.darkMode,
            #animeRecommendationList tr.darkMode,
            #animeRecommendationList td.darkMode,
            .td-container.darkMode,
            #table-skeleton.darkMode,
            #table-skeleton tr.darkMode,
            #table-skeleton td.darkMode,
            .flexdatalist-multiple.darkMode,
            .flexdatalist-alias.darkMode,
            .flexdatalist-results.darkMode{
                background-color: rgb(21,31,46) !important;
                color: rgb(185, 202, 221) !important
            }
            .flexdatalist-results.darkMode,
            .flexdatalist-results.darkMode>.item{
                border: 1px solid rgb(21,34,50) !important;
            }
            #anime-table th.darkMode,
            #animeRecommendationList td.darkMode,
            #username.darkMode,
            .flexdatalist-multiple.darkMode{
                border: 1px solid rgb(21,34,50) !important;
            }
            #table-skeleton td.darkMode,
            #table-skeleton th.darkMode{
                border-top: none !important;
                border-right: none !important;
                border-left: none !important;
                border-bottom: 1px solid rgb(21,34,50) !important;
            }
            #anime-table th:not(:first-child).darkMode,
            #table-skeleton th.darkMode,
            .flexdatalist-multiple>.value.darkMode{
                background-color: rgb(67,81,97) !important;
                color: rgb(185, 202, 221) !important;
            }
            #animeRecommendationList a.darkMode,
            .swal2-footer a.darkMode{
                color: rgb(110, 185, 255) !important;
            }
            #table-skeleton span.darkMode{
                background-image: linear-gradient(90deg, #394452  0px, #394756 40px, #394452 80px) !important;
            }
            #nav.darkMode,
            #pager.darkMode,
            #pageNumberOptions.darkMode>*,
            #pageNumberOptions>option.darkMode,
            .swal2-popup.darkMode,
            .swal2-popup-custom.darkMode{
                background-color: rgb(21,34,50) !important;
                color: rgb(185, 202, 221) !important;
            }
            #dataStatusUpdate.darkMode{
                color: #6eb9ff !important;
            }
            .swal2-modal.darkMode{
                background-color: rgb(11,22,34) !important;
            }
            .swal2-validation-message.darkMode{
                background-color: transparent !important;
                color: rgb(185, 202, 221) !important;
            }
            .spinner.darkMode{
                border: 2px solid #f3f3f3;
                border-top: 2px solid #6eb9ff;
                border-radius: 50%;
                width: 13px;
                min-width: 13px;
                height: 13px;
                min-height: 13px;
                animation: spin 2s linear infinite;
            }
            #menu-container>div>button.darkMode{
                -moz-box-shadow: 0 3px 20px 0 #6e89af38 !important;
                -webkit-box-shadow: 0 3px 20px 0 #6e89af38 !important;
                box-shadow: 0 3px 20px 0 #6e89af38 !important;
            }
            .darkMode::placeholder{
                opacity: 1 !important;
                color: rgb(131,144,160) !important;
            }
            .darkMode:-ms-input-placeholder,
            .darkMode::-ms-input-placeholder{
                color: rgb(131,144,160) !important;
            }
            /* Dark Mode */
            .orange{
                color: rgb(255,152,0);
            }
            .red{
                color: rgb(239,48,81);
            }
            .purple{
                color: purple;
            }
            .iris{
                color: rgb(0,188,212);
            }
            #filters{
                height: 100px !important;
                max-height: 100px !important;
                min-height: 100px !important;
            }
            #warnAnimeContainer,
            #filterAlgoContainer{
                -ms-user-select: none;
                -webkit-user-select: none;
                user-select: none;
                overscroll-behavior: contain
            }
            .flexdatalist-results li{
                user-select: all;
            }
            #dataStatusHolder{
                height: 20px;
                min-height: 20px;
                max-height: 20px;
            }
            #dataStatusContainer{
                justify-content: center;
                align-items: center;
            }
            #dataStatusWrapper{
                display: flex;
                flex-wrap: nowrap;
                align-items: center;
                overflow-x: auto;
            }
            .dataStatusSpinner{
                flex: 1;
                display: flex;
                justify-content: end;
            }
            #dataStatus{
                display: flex;
                flex-wrap: nowrap;
                justify-content: center;
                margin: 0 !important;
                overflow-x: auto;
                cursor: pointer;
            }
            #dataStatus{
                text-align: center;
            }
            #dataStatus>span{
                padding-block: 0.5ch;
                white-space: nowrap;
                display: flex;
                align-items: center;
                gap: 0.75ch;
                user-select: text;
            }
            #dataStatusUpdate{
                color: #005885 !important;
                font-size: 1rem !important;
                font-weight: bolder !important;
            }
            .td-container{
                max-height: 50px !important;
                overflow-y: scroll !important;
                background-color: transparent;
            }
            .txt-center{
                text-align: center !important;
            }
            #animeRecommendationList > tr > td:first-child > div{
                display: flex !important;
                align-items: center !important;
            }
            #next,
            #prev,
            #first,
            #last{
                outline: none !important;
                box-shadow: none !important;
            }
            .flexdatalist-alias{
                height: 41px !important;
            }
            /* Top of Loader */
            .topOfLoader{
                z-index: 10000 !important;
            }
            /* Skeleton Table */
            .table-skeleton {
                color: #666;
                width: 100%;
                padding: 0;
            }
            .table-skeleton th{
                border-top: 1px solid #E5E5E5;
                border-bottom: 1px solid #E5E5E5;
                padding: 12px 10px;
                text-align: left;
            }
            .table-skeleton td{
                border-top: 0px solid #E5E5E5;
                border-bottom: 1px solid #E5E5E5;
                padding: 12px 10px;
                vertical-align: top;
            }
            .table-skeleton span{
                width: calc(100% - 5px);
                height: 8px;
                border-radius: 3px;
                background-image: linear-gradient(90deg, #ddd 0px, #dfdfdf 40px, #ddd 80px) !important;
                background-size: 600px;
                animation: shine-lines-table 1.6s infinite linear;
                display: inline-block;
                min-width:15px;
            }
            .table-skeleton span.sub-temp{
                width: calc(100% - 50%);
                margin-top: 5px;
            }
            .table-skeleton span.sub-temp-three{
                width:calc(100% - 70%);
                display:block
            }
            .tsk-col1{
                    width: 25px;
            }
            .tsk-col2{
                    width: 60px;
            }
            .tsk-col3{
                    width: 45px;
            }
            .tsk-col4{
                    width: 344px;
            }
            .tsk-col5{
                    width: 145px;
            }
            .tsk-col6{
                    width: 113px;
            }
            .tsk-col7{
                    width: 73px;
            }
            .tsk-col8{
                    width: 160px;
            }
            .tsk-col9{
                    width: 92px;
            }
            @keyframes shine-lines-table {
                0% {
                    opacity:0.4;
                }
                40%{
                    opacity:0.8;
                }
                100% {
                    opacity:0.4;
                }
            }
            #fps{
                position: fixed;
                padding: 1em;
                display: flex;
                justify-content: center;
                align-items: center;
                text-align: center;
                top: 0;
                right: 0;
                z-index: 9999999;
                background: rgb(0,0,0,0.75);
                color: red;
                max-height: 4em;
                min-width: 8em;
                font-size: 1rem;
                font-weight: bold;
                border-radius: 10%;
            }
            /* Skeleton Table */
        </style>
</head>
<body class="darkMode noscroll">
<nav id="nav" class="nav darkMode">
    <div><h1 id="menuTitle" class="textLogo copy-value" data-copy-value="Kanshi.">Kanshi.</h1></div>
    <!-- <div id="fps">--</span> FPS</div> -->
    <div><img id="menuIcon" src="./public/logo.png" alt="menubar"></div>
</nav>
<div id="menu-container">
    <div>
        <button class="darkMode" id="updateBtn">Update</button>
        <button class="darkMode" id="showAllAnime">Show All</button>
        <input class="darkMode" type="file" id="importFile" style="display: none;" accept=".json"/>
        <button class="darkMode" id="importBtn">Import</button>
        <button class="darkMode" id="exportBtn">Export</button>
        <!-- Android -->
        <button class="darkMode" id="chooseExportPathBtn">Change Export Folder</button>
        <!-- Android -->
        <button class="darkMode" id="warnAnimeBtn">Choose Content to Warn</button>
        <button class="darkMode" id="filterAlgoBtn">Filter Algorithm Contents</button>
        <button class="darkMode" id="themeBtn">Dark Mode</button>
        <button class="darkMode" id="hideKidsAnimeBtn">Hide Kids Anime</button>
        <button class="darkMode" id="hideUnwatchedSequelsBtn">Hide Unwatched Sequels</button>
        <button class="darkMode" id="updateIntervalBtn">Update Every Hour</button>
        <button class="darkMode" id="exportIntervalBtn">Export Every Hour</button>
        <button class="darkMode" id="sign-up">Create Another Account</button>
        <!-- Android -->
        <button class="darkMode" id="restart">Restart</button>
        <!-- Android -->
    </div>
</div>
<header id="header">
    <div id="overlay" class="darkMode">
        <h1 class="textLogo copy-value" data-copy-value="Kanshi.">Kanshi.</h1>
        <h3 class="copy-value" data-copy-value="Anime - Anilist">Anime - Anilist</h3>
        <h3 class="copy-value" data-copy-value="Recommendations">Recommendations</h3>
    </div>
</header>
<div id="Home" class="darkMode">
    <div id="searchData" class="darkMode">
        <div id="userInputContainer">
            <input class="darkMode" placeholder="Anilist Username" name="username" id="username" type="text">
        </div>
        <div id="filters" class="filter-container">
            <input type="text"
                   placeholder="Filter Table/List Contents (Include: Content / Exclude: !Content / WScore>=N / etc.)"
                   class="flexdatalist"
                   data-search-in="info"
                   multiple="multiple"
                   data-min-length="1"
                   data-search-by-word="true"
                   data-max-shown-results="7"
                   name="filter">
        </div>
        <div class="btn-container">
            <button id="searchBtn" class="btn darkMode" type="submit">Search</button>
        </div>
    </div>
    <div id="dataStatusHolder">
        <div id="dataStatusContainer" class="data-status-container">
            <div id="dataStatusWrapper">
                <div id="dataStatusSpinnerHome" style="display: none;"><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner darkMode"></div></div>
                <h6 id="dataStatus" class="copy-value" data-copy-value="Latest Anilist Update: N/A"><b class="darkMode" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A</h6>
            </div>
        </div>
    </div>

    <!-- Table -->
    <div id="table-responsive" class="table-responsive">
        <!-- Table Skeleton -->
        <table cellpadding="0" cellspacing="0" width="100%" id="table-skeleton" class="table-skeleton darkMode">
            <tr class="darkMode">
                <th class="tsk-col1 darkMode"><span class="darkMode"></span></th>
                <th class="tsk-col4 darkMode"><span class="darkMode"></span></th>
                <th class="tsk-col5 darkMode"><span class="darkMode"></span></th>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
            <tr class="darkMode">
                <td class="tsk-col1 darkMode"><span class="darkMode"></span></td>
                <td class="tsk-col4 darkMode">
                    <span class="darkMode"></span>
                    <span class="sub-temp darkMode"></span>
                </td>
                <td class="tsk-col5 darkMode"><span class="darkMode"></span></td>
            </tr>
        </table>
        <!-- Table Skeleton -->
        <!-- Original Table -->
        <table id="anime-table" class="tablesorter table table-bordered table-striped display-none darkMode">
            <thead class="darkMode">
            <tr class="anime-table-headers darkMode">
                <th id="hiddenUnhiddenBtn" class="trigger-btn sorter-false show-hidden-anime-btn darkMode copy-value" data-copy-value="Unhidden">Unhidden</th>
                <th class="darkMode copy-value" data-copy-value="WScore">WScore</th>
                <th class="darkMode copy-value" data-copy-value="Title">Title</th>
                <th class="darkMode copy-value" data-copy-value="Format">Format</th>
                <th class="darkMode copy-value" data-copy-value="Top Similarities">Top Similarities</th>
                <th class="darkMode copy-value" data-copy-value="Score">Score</th>
                <th class="darkMode copy-value" data-copy-value="User Score">User Score</th>
                <th class="darkMode copy-value" data-copy-value="Average Score">Average Score</th>
                <th class="darkMode copy-value" data-copy-value="Popularity">Popularity</th>
                <th class="darkMode copy-value" data-copy-value="User Status">User Status</th>
                <th class="darkMode copy-value" data-copy-value="Status">Status</th>
            </tr>
            </thead>
            <tbody id="animeRecommendationList" class="darkMode">
            <tr class="item darkMode copy-value" data-copy-value="No Data" role="row">
                <td class="darkMode" style="padding: 1.5em !important;" colspan="11">
                    <i class="fa fa-solid fa-file fa-xl darkMode" style="padding-right: 1ch;"></i>
                    No Data
                </td>
            </tr>
            </tbody>
        </table>
        <!-- Original Table -->
    </div>
    <!-- Table -->
</div>

<!-- pager -->
<div id="pager" class="pager darkMode">
    <form class="pager-form">
        <div id="first" class="first"><h5>First</h5></div>
        <div id="prev" class="prev"><h5>Prev</h5></div>
        <div id="selectPageNumber">
            <select id="pageNumberOptions" class="custom-select pagenum darkMode" title="Select page number"></select>
        </div>
        <div id="next" class="next"><h5>Next</h5></div>
        <div id="last" class="last"><h5>Last</h5></div>
    </form>
</div>

<div id="warnAnimeContainer" class="swal2-container-custom swal2-center-custom swal2-backdrop-show-custom" style="display: none; overflow-y: auto;">
    <div id="warnAnimeModal" class="swal2-popup-custom swal2-modal-custom swal2-hide-custom darkMode" style="display: grid;">
        <div class="swal2-html-container-custom" style="display: block;">
            Content Warning
        </div>
        <div class="swal2-html-container-custom" style="display: block;">
            <div class="filter-container-custom">
                <input type="text"
                       placeholder="Yellow-Warning (Content) or Red-Warning (!Content)"
                       class="flexdatalistWarnAnime"
                       data-search-in="info"
                       multiple="multiple"
                       data-min-length="1"
                       data-search-by-word="true"
                       data-max-shown-results="7"
                       name="filter">
            </div>
        </div>
        <div class="swal2-actions-custom" style="display: flex;">
            <button id="cancelWarnAnime" type="button" class="darkMode swal2-deny-custom swal2-styled-custom swal2-default-outline-custom" style="display: inline-block; background-color: rgb(226, 125, 129);">Later</button>
            <button id="submitWarnAnime" type="button" class="darkMode swal2-confirm-custom swal2-styled-custom swal2-default-outline-custom" style="display: inline-block; background-color: rgb(0, 0, 0);">Submit</button>
        </div>
        <div class="swal2-timer-progress-bar-container-custom"></div>
    </div>
</div>

<div id="filterAlgoContainer" class="swal2-container-custom swal2-center-custom swal2-backdrop-show-custom" style="display: none; overflow-y: auto;">
    <div id="filterAlgoModal" class="darkMode swal2-popup-custom swal2-modal-custom" style="display: grid;">
        <div class="swal2-html-container-custom" style="display: block;">
            Filter Algorithm Contents
        </div>
        <div class="swal2-html-container-custom" style="display: block;">
            <div class="filter-container-custom">
                <input type="text"
                       placeholder="Filter Algorithm Contents (Include: Content / Exclude: !Content / WScore>=N / etc.)"
                       class="flexdatalistFilterAlgo"
                       data-search-in="info"
                       multiple="multiple"
                       data-min-length="1"
                       data-search-by-word="true"
                       data-max-shown-results="7"
                       name="filter">
            </div>
        </div>
        <div class="darkMode swal2-validation-message" id="filterAlgo-validation" style="display: none;">
            <div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner darkMode"></div></div>
                <div>Checking Username...</div>
            </div>
        </div>
        <div class="swal2-actions-custom" style="display: flex;">
            <button id="cancelFilterAlgo" type="button" class="darkMode swal2-deny-custom swal2-styled-custom swal2-default-outline-custom" style="display: inline-block; background-color: rgb(226, 125, 129);">Later</button>
            <button id="submitFilterAlgo" type="button" class="darkMode swal2-confirm-custom swal2-styled-custom swal2-default-outline-custom" style="display: inline-block; background-color: rgb(0, 0, 0);">Submit</button>
        </div>
        <div class="swal2-timer-progress-bar-container-custom"></div>
    </div>
</div>

<div id="loader">
    <div><h1 id="loaderText">Loading...</h1></div>
</div>

<script defer>
    // Declare Global Variables
        // Production Version
    const version = "6.8",
          backUpVersion = 4.5;
        // IndexDB
    let request, db,
        // Saved Data
    savedUsername, haveSavedRecScheme, haveSavedUserList, haveSavedAnimeEntries, savedHiddenAnimeIDs,
    savedFilters, savedWarnAnime, savedFilterAlgo, savedBackUpVersion,
    savedHiddenTablePage, savedUnhiddenTablePage, savedTableStatus, savedYscroll, savedSort,
    savedTheme, kidsAnimeIsHidden, hideUnwatchedSequels, savedFilterOptionsJson,
    exportIntervalIsActive, updateIntervalIsActive, exportIntervalStartDate, updateIntervalStartDate,
    exportIntervalTimeout = [], updateIntervalTimeout = [],
        // Android
    exportPathIsAvailable,
        // Android
        // Load Saved API Request State
    updateIDs = [],
    savedAnalyzeVariableTime, savedUpdateAnalyzeAnimeTime, savedDeepUpdateTime, lastSavedUpdateTime,
    isRunning = false, requestIsRunning = false, isLoading = false, isScrolling = false, scrollTimeout,
    willAutoUpdate = false, updateStateText = [], checkFiltersFocus = [],
        // Helper
    pageInits = true, versionUpdate = false, initStartTime,
    pageLoadStartDate = new Date().getTime(), maxClientHeight, dataStatusPrio = false,
        // Jquery Elements
    htmlEl, bodyEl, usernameEl, pagerEl, menuContainerEl, pageNumberOptionsEl,
    animeTableEl, tableSkeleton, animeRecommendationListEl, filtersEl,
    warnAnimeContainerEl, warnAnimeModalEl,
    filterAlgoContainerEl, filterAlgoModalEl, filterAlgoValidationEl,
    dataStatusEl, dataStatusSpinnerHomeEl,
    searchBtnEl, updateBtnEl, importBtnEl, importFileEl, exportIntervalBtnEl, updateIntervalBtnEl,
    hiddenUnhiddenBtnEl, showAllAnimeBtnEl, hideKidsAnimeBtnEl, hideUnwatchedSequelsBtnEl, themeBtnEl,
        // Workers
    worker3, worker4, worker5, worker6, worker7, worker8
        // Browser
    ,notificationGranted = false
        // Browser

    window.onload = async () => {
        // Get Client Height
        maxClientHeight = window.outerHeight
        // Initialize Jquery Elements
        htmlEl = await $(document.documentElement),
        bodyEl = await $("body"),
        usernameEl = await $("#username"),
        pagerEl = await $("#pager"),
        menuContainerEl = await $("#menu-container"),
        pageNumberOptionsEl = await $("#pageNumberOptions"),
        animeTableEl = await $("#anime-table"),
        tableSkeleton = await $("#table-skeleton"),
        animeRecommendationListEl = await $("#animeRecommendationList"),
        filtersEl = await $("#filters"),
        warnAnimeContainerEl = await $("#warnAnimeContainer"),
        warnAnimeModalEl = await $("#warnAnimeModal"),
        filterAlgoContainerEl = await $("#filterAlgoContainer"),
        filterAlgoModalEl = await $("#filterAlgoModal")
        filterAlgoValidationEl = await $("#filterAlgo-validation"),
        dataStatusEl = await $("#dataStatus"),
        dataStatusSpinnerHomeEl = await $("#dataStatusSpinnerHome"),
        searchBtnEl = await $("#searchBtn"),
        updateBtnEl = await $("#updateBtn"),
        importBtnEl = await $("#importBtn"),
        importFileEl = await $("#importFile"),
        exportIntervalBtnEl = await $("#exportIntervalBtn"),
        updateIntervalBtnEl = await $("#updateIntervalBtn"),
        hiddenUnhiddenBtnEl = await $("#hiddenUnhiddenBtn"),
        showAllAnimeBtnEl = await $("#showAllAnime"),
        hideUnwatchedSequelsBtnEl = await $("#hideUnwatchedSequelsBtn"),
        hideKidsAnimeBtnEl = await $("#hideKidsAnimeBtn"),
        themeBtnEl = await $("#themeBtn")
        // Init Page
        return await new Promise(async(resolve)=>{
            // Create/Load IndexedDB
            await IDBinit()
            resolve()
        }).then(async()=>{
            // Init Global Saved Data from IndexedDB
            return await new Promise(async(resolve)=>{
                haveSavedAnimeEntries = !jsonIsEmpty(await retrieveJSON("savedAnimeEntries") || {})
                haveSavedRecScheme = !jsonIsEmpty(await retrieveJSON("savedRecScheme") || {})
                haveSavedUserList = !jsonIsEmpty(await retrieveJSON("savedUserList") || {})
                lastSavedUpdateTime = await retrieveJSON("lastSavedUpdateTime") || 0
                savedTheme = await retrieveJSON("savedTheme") || "darkMode"
                savedUnhiddenTablePage = await retrieveJSON("savedUnhiddenTablePage") || 0
                savedHiddenTablePage = await retrieveJSON("savedHiddenTablePage") || 0
                savedTableStatus = await retrieveJSON("savedTableStatus") || "Unhidden"
                savedUsername = await retrieveJSON("savedUsername") || ""
                savedFilterOptionsJson = await retrieveJSON("savedFilterOptionsJson") || []
                savedFilters = await retrieveJSON("savedFilters") || ["limit top wscore: 100", "!top similarities: !staffs", "!user status: !completed", "!user status: !dropped"]
                savedBackUpVersion = await retrieveJSON(`backUpVersion`) || 0
                kidsAnimeIsHidden = await retrieveJSON("kidsAnimeIsHidden") ?? true
                hideUnwatchedSequels = await retrieveJSON("hideUnwatchedSequels") ?? true
                initStartTime = await retrieveJSON("initStartTime")
                savedHiddenAnimeIDs = await retrieveJSON("savedHiddenAnimeIDs") || {}
                savedSort = await retrieveJSON("savedSort") || [1,1]
                savedYscroll = await retrieveJSON("savedYscroll") || 0.0
                savedFilterAlgo = await retrieveJSON("savedFilterAlgo") || ["minimum sample size: 2","include unknown variables: false"]
                savedWarnAnime = await retrieveJSON("savedWarnAnime") || [ "!genre: !ecchi","!tag: !boys' love","tag: cgi","!tag: !ero guro","!tag: !female harem",
                                                                            "tag: full cgi","!tag: !male harem","!tag: !mixed gender harem",
                                                                            "!tag: !nudity","!tag: !slavery","!tag: !suicide","!tag: !yuri","!tag: !netorare", "!tag: !rape"
                                                                         ]
                updateIntervalIsActive = await retrieveJSON("updateIntervalIsActive") ?? false
                updateIntervalStartDate = await retrieveJSON("updateIntervalStartDate") || new Date()
                exportIntervalIsActive = await retrieveJSON("exportIntervalIsActive") ?? false
                exportIntervalStartDate = await retrieveJSON("exportIntervalStartDate") || new Date()
                // Android
                exportPathIsAvailable = await retrieveJSON("exportPathIsAvailable") ?? false
                // Android
                savedAnalyzeVariableTime = await retrieveJSON("savedAnalyzeVariableTime") || [15]
                savedUpdateAnalyzeAnimeTime = await retrieveJSON("savedUpdateAnalyzeAnimeTime") || [15]
                savedDeepUpdateTime = await retrieveJSON("savedDeepUpdateTime") || [6700]
                versionUpdate = await retrieveJSON("versionUpdate") ?? false
                resolve()
            })
        }).then(async()=>{
            // Load Initial Theme
            await loadTheme(savedTheme)
            // Load Event Listeners
            return await new Promise((resolve)=>{
                usernameEl.on('keypress', (e) =>{
                    if(e.which===13&&!isLoading) {
                        searchBtnEl.click()
                    }
                })
                filtersEl.on('keypress', (e) =>{
                    if( e.which===13
                        &&!pageInits
                        &&!isLoading
                        &&e.target.id==="flex0"
                        &&!e.target.value
                        &&usernameEl.val()
                    ){
                        searchBtnEl.click()
                    }
                })
                searchBtnEl.on('click', ()=>{
                    if(haveSavedRecScheme) {
                        let newUsername = usernameEl.val()
                        if(!newUsername){
                            usernameEl[0]?.setCustomValidity("Anilist Username is Required!")
                            usernameEl[0]?.reportValidity()
                        } else {
                            if(equalsNCS(newUsername,savedUsername)){
                                LoadData()
                            } else {
                                updateNotify()
                            }
                        }
                    } else {
                        updateNotify()
                    }
                })
                $("#nav, #menu-container").on("click",()=>{
                    if(menuContainerEl.css("display")==="none"){
                        menuContainerEl.fadeIn(250)
                    } else {
                        menuContainerEl.fadeOut(250)
                    }
                })
                $("#pager, #menu-container>div>button, #menu-container>div>input").on('click', (e)=>{
                    e.stopPropagation()
                })
                dataStatusEl.add(updateBtnEl).on('click',(e) =>{
                    updateNotify()
                })
                hiddenUnhiddenBtnEl.on('click', async()=>{
                    if(!isLoading){
                        isLoading = true
                        if(savedUsername&&haveSavedRecScheme){
                            let state = await hiddenUnhiddenBtnEl.text()
                            if(state==="Unhidden"){
                                let filterInput = await $("#flex0")
                                if(filterInput.length){
                                    await filterInput.val("hidden")
                                    let e = await $.Event("keyup",{keyCode:13})
                                    await filterInput.trigger(e)
                                    await filterInput.val("")
                                }
                                hiddenUnhiddenBtnEl.text("Hidden")
                                savedTableStatus = await "Hidden"
                                setTimeout(()=>{
                                    saveJSON(savedTableStatus,"savedTableStatus")
                                },0)
                                await LoadData()
                                pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                            } else {
                                let filters = await $("ul.flex0>.value")
                                await filters.children(".text").toArray()?.forEach(async(e,idx)=>{
                                    if(e?.textContent?.toLowerCase()==="hidden"){
                                        await $("#flex0").prop("disabled", true)
                                        await filters.eq(idx).children(".fdl-remove").trigger("click")
                                        await $("#flex0").prop("disabled", false)
                                    }
                                })
                                await hiddenUnhiddenBtnEl.text("Unhidden")
                                savedTableStatus = await "Unhidden"
                                setTimeout(()=>{
                                    saveJSON(savedTableStatus,"savedTableStatus")
                                },0)
                                await LoadData()
                                pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                            }
                        }
                    }
                })
                showAllAnimeBtnEl.on('click', ()=>{
                    Swal.fire({
                        heightAuto: false,
                        text: "Do you want to show all your hidden anime? This will remove all hidden Anime in the hidden's list!",
                        showConfirmButton: true,
                        confirmButtonText: "Yes",
                        showDenyButton: true,
                        denyButtonText: "No",
                        confirmButtonColor: '#000',
                        denyButtonColor: '#e27d81',
                        icon: "question",
                        reverseButtons: true
                    })
                    .then(async(value) => {
                        if(value.isConfirmed){
                            isLoading = true
                            savedHiddenAnimeIDs = await {}
                            let filters = await $("ul.flex0>.value")
                            await filters.children(".text").toArray()?.forEach(async(e,idx)=>{
                                if(e?.textContent?.toLowerCase()==="hidden"){
                                    await $("#flex0").prop("disabled", true)
                                    await filters.eq(idx).children(".fdl-remove").trigger("click")
                                    await $("#flex0").prop("disabled", false)
                                }
                            })
                            hiddenUnhiddenBtnEl.text("Unhidden")
                            savedTableStatus = await "Unhidden"
                            await animeTableEl.trigger("pageSet",savedUnhiddenTablePage)
                            pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                            showAllAnimeBtnEl.hide()
                            menuContainerEl.fadeOut(500)
                            setTimeout(()=>{
                                saveJSON(savedHiddenAnimeIDs, "savedHiddenAnimeIDs")
                                saveJSON(savedTableStatus,"savedTableStatus")
                            },0)
                            await LoadData()
                            Swal.fire({
                                heightAuto: false,
                                text: "All hidden anime has now been successfully transferred to your List!",
                                icon: "success",
                                confirmButtonColor: "#000"
                            })
                            return
                        }
                    })
                })
                importBtnEl.on("click", async()=>{
                    if(savedUsername){
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to import your backup data?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        }).then(async(value)=>{
                            if(value.isConfirmed){
                                importFileEl.click()
                            }
                        })
                    } else {
                        importFileEl.click()
                        menuContainerEl.hide()
                    }
                })
                importFileEl.on("change",async(event)=>{
                    const importedFile = await importFileEl?.[0]?.files?.[0]
                    if(importedFile){
                        new Promise((resolve,reject)=>{
                            if(savedUsername){
                                const filename = importedFile.name
                                Swal.fire({
                                    heightAuto: false,
                                    text: `File ${filename?'named ['+filename+'] ':''}has been detected, do you want to continue the import? This will remove your current data!`,
                                    showConfirmButton: true,
                                    confirmButtonText: "Yes",
                                    showDenyButton: true,
                                    denyButtonText: "No",
                                    confirmButtonColor: '#000',
                                    denyButtonColor: '#e27d81',
                                    icon: "question",
                                    reverseButtons: true
                                })
                                .then(async(value) => {
                                    if(value.isConfirmed){
                                        resolve()
                                    } else {
                                        reject()
                                    }
                                })
                            } else {
                                $(".swal2-validation-message")
                                    .addClass("no-before")
                                    .css({display:"flex"})
                                    .html(
                                    `<div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                                        <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                        <div>Importing Data...</div>
                                    </div>`
                                )
                                resolve()
                            }
                        }).then(()=>{
                            if(worker8) worker8.terminate()
                            worker8 = new Worker(`./js-css/worker/import-${version}.js`)
                            // Check Parameters
                            worker8.postMessage({
                                importedFile:importedFile,
                                backUpVersion:backUpVersion
                            })
                            worker8.onmessage = ({data}) =>{
                                const status = data.status
                                if(status==='notify'){
                                    if(data.fileLoaded ?? false){
                                        dataStatusPrio = true
                                        importBtnEl.addClass('selected')
                                        if(savedUsername) menuContainerEl.fadeOut(250)
                                        dataStatusSpinnerHomeEl.show()
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Importing data, please wait...</span>`)
                                    } else if(data.validFile ?? false) {
                                        // Stop Updates for Past Data
                                        if(worker3) worker3.terminate()
                                        if(worker4) worker4.terminate()
                                        if(worker5) worker5.terminate()
                                        requestIsRunning = false
                                        importBtnEl.removeClass('selected')
                                    } else if(data.doneImporting ?? false){
                                        importFileEl.val(null)
                                        dataStatusPrio = false
                                        dataStatusSpinnerHomeEl.hide()
                                        let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                                            .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                                        Swal.fire({
                                            heightAuto: false,
                                            text: "Data has been updated!",
                                            icon: "success",
                                            confirmButtonColor: "#000"
                                        })
                                        if(!savedUsername){
                                            // Reset Custom Validation
                                            filterAlgoValidationEl.html("").hide()
                                        }
                                    }
                                } else if(status==='update'){
                                    if(data.savedUsername ?? false) {
                                        savedUsername = data.savedUsername
                                        usernameEl.val(savedUsername)
                                    } else if(data.haveSavedRecScheme!==undefined) {
                                        haveSavedRecScheme = data.haveSavedRecScheme
                                    } else if(data.haveSavedAnimeEntries!==undefined) {
                                        haveSavedAnimeEntries = data.haveSavedAnimeEntries
                                    } else if(data.haveSavedUserList!==undefined) {
                                        haveSavedUserList = data.haveSavedUserList
                                    } else if(data.versionUpdate!==undefined) {
                                        versionUpdate = data.versionUpdate
                                    } else if(data.savedHiddenAnimeIDs ?? false) {
                                        savedHiddenAnimeIDs = data.savedHiddenAnimeIDs
                                        if(data.noHiddenAnime!==undefined){
                                            showAllAnimeBtnEl.hide()
                                        } else {
                                            showAllAnimeBtnEl.show()
                                        }
                                    } else if(data.lastSavedUpdateTime ?? false) {
                                        lastSavedUpdateTime = data.lastSavedUpdateTime
                                    } else if(data.savedAnalyzeVariableTime ?? false) {
                                        savedAnalyzeVariableTime = data.savedAnalyzeVariableTime
                                    } else if(data.savedUpdateAnalyzeAnimeTime ?? false) {
                                        savedUpdateAnalyzeAnimeTime = data.savedUpdateAnalyzeAnimeTime
                                    } else if(data.savedDeepUpdateTime ?? false) {
                                        savedDeepUpdateTime = data.savedDeepUpdateTime
                                    } else if(data.savedWarnAnime ?? false) {
                                        new Promise(async(resolve)=>{
                                            savedWarnAnime = await data.savedWarnAnime
                                            await warnAnimeContainerEl.css({visibility:"hidden"}).show()
                                            // Remove Current Filters
                                            let warnInfo = await $("ul.flex1>.value")
                                            await warnInfo.children(".text").toArray()?.forEach(async(e,idx)=>{
                                                await $("#flex1").prop("disabled", true)
                                                await warnInfo.eq(idx).children(".fdl-remove").trigger("click")
                                                await $("#flex1").prop("disabled", false)
                                            })
                                            resolve()
                                        }).then(async()=>{
                                            let warnAnimeInput = await $("#flex1")
                                            for(let i=0; i<savedWarnAnime.length; i++) {
                                                await warnAnimeInput.val(savedWarnAnime[i])
                                                let e = await $.Event("keyup",{keyCode:13})
                                                await warnAnimeInput.trigger(e)
                                                await warnAnimeInput.val("")
                                            }
                                            await warnAnimeContainerEl.css({visibility:"visible"}).hide()
                                        })
                                    } else if(data.savedFilterAlgo ?? false) {
                                        new Promise(async(resolve)=>{
                                            savedFilterAlgo = await data.savedFilterAlgo
                                            await filterAlgoContainerEl.css({visibility:"hidden"}).show()
                                            // Remove Current Filters
                                            let filterInfo = await $("ul.flex2>.value")
                                            await filterInfo.children(".text").toArray()?.forEach(async(e,idx)=>{
                                                await $("#flex2").prop("disabled", true)
                                                await filterInfo.eq(idx).children(".fdl-remove").trigger("click")
                                                await $("#flex2").prop("disabled", false)
                                            })
                                            resolve()
                                        }).then(async()=>{
                                            // Reload Filters
                                            let filterAlgoInput = await $("#flex2")
                                            for(let i=0; i<savedFilterAlgo.length; i++){
                                                await filterAlgoInput.val(savedFilterAlgo[i])
                                                let e = await $.Event("keyup",{keyCode:13})
                                                await filterAlgoInput.trigger(e)
                                                await filterAlgoInput.val("")
                                            }
                                            await filterAlgoContainerEl.css({visibility:"visible"}).hide()
                                        })
                                    }
                                } else if(status==='LoadData'){
                                    dataStatusPrio = false
                                    LoadData()
                                } else if(status==='Update'){
                                    Update(false)
                                } else if(status==='error'){// Error
                                    const error = data.error
                                    console.error(error)
                                    importBtnEl.removeClass('selected')
                                    importFileEl.val(null)
                                    if(savedUsername){
                                        Swal.fire({
                                            heightAuto: false,
                                            text: error,
                                            icon: "error",
                                            confirmButtonColor: "#000"
                                        })
                                    } else {
                                        $(".swal2-validation-message")
                                            .addClass("no-before").removeClass("no-before")
                                            .addClass("error-before")
                                            .html(error)
                                            .css({display:"flex"})
                                    }
                                    dataStatusPrio = false
                                    dataStatusSpinnerHomeEl.hide()
                                    let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                                    dataStatusEl
                                        .empty()
                                        .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                                        .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                                    return
                                }
                            }
                            worker8.onerror = (error) => {
                                console.error(error)
                                importBtnEl.removeClass('selected')
                                importFileEl.val(null)
                                if(savedUsername){
                                    Swal.fire({
                                        heightAuto: false,
                                        text: error,
                                        icon: "error",
                                        confirmButtonColor: "#000"
                                    })
                                }
                                dataStatusPrio = false
                                dataStatusSpinnerHomeEl.hide()
                                let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                                dataStatusEl
                                    .empty()
                                    .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                                    .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                                return
                            }
                        }).catch((error)=>{
                            console.error(error)
                            importFileEl.val(null)
                            importBtnEl.removeClass('selected')
                            return
                        })
                    }
                })
                $("#exportBtn").on("click", async()=>{
                    // Android
                    if(exportPathIsAvailable) {
                    // Android
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to export your data?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then(async(value) => {
                            if(value.isConfirmed){
                                dataStatusPrio = true
                                await menuContainerEl.fadeOut(250)
                                dataStatusSpinnerHomeEl.show()
                                dataStatusEl
                                    .empty()
                                    .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                await backUpData()
                                resolve()
                            }
                        })
                    // Android
                    } else {
                        console.log("WebtoApp: Choose an Export Path")
                    }
                    // Android
                })
                updateIntervalBtnEl.on("click",async()=>{
                    if(updateIntervalIsActive){
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to disable auto update for your recommendations list every hour?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then(async(value) => {
                            if(value.isConfirmed){
                                updateIntervalBtnEl.removeClass("selected")
                                updateIntervalIsActive = await false
                                setTimeout(()=>{
                                    saveJSON(updateIntervalIsActive,"updateIntervalIsActive")
                                },0)
                            }
                        })
                    } else {
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to enable auto update for your recommendations list every hour?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then(async(value) => {
                            if(value.isConfirmed){
                                updateIntervalBtnEl.addClass("selected")
                                updateIntervalIsActive = await true
                                updateIntervalStartDate = await updateIntervalStartDate || new Date()
                                if((new Date).getTime()-(updateIntervalStartDate.getTime())>3600000){// 1hrs
                                    if(!requestIsRunning){
                                        if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                        willAutoUpdate = true
                                        Update(true)
                                    }
                                    // Interval
                                    if(!updateIntervalTimeout.length){
                                        let saveUpdateIntervalTimeout = setInterval(async()=>{
                                            if(!requestIsRunning){
                                                if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                                willAutoUpdate = true
                                                Update(true)
                                            }
                                        },3600000)
                                        updateIntervalTimeout.push(saveUpdateIntervalTimeout)
                                    }
                                } else {
                                    // Timeout
                                    setTimeout(async()=>{
                                        if(!requestIsRunning){
                                            if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                            willAutoUpdate = true
                                            Update(true)
                                        }
                                        // Interval
                                        if(!updateIntervalTimeout.length){
                                            let saveUpdateIntervalTimeout = setInterval(async()=>{
                                                if(!requestIsRunning){
                                                    if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                                    willAutoUpdate = true
                                                    Update(true)
                                                }
                                            },3600000)
                                            updateIntervalTimeout.push(saveUpdateIntervalTimeout)
                                        }
                                    },3600000-((new Date).getTime()-(updateIntervalStartDate.getTime())))
                                }
                                setTimeout(()=>{
                                    saveJSON(updateIntervalIsActive,"updateIntervalIsActive")
                                    saveJSON(updateIntervalStartDate,"updateIntervalStartDate")
                                },0)
                            }
                        })
                    }
                })
                exportIntervalBtnEl.on("click",async()=>{
                    // Android
                    if(exportPathIsAvailable) {
                    // Android
                        if(exportIntervalIsActive){
                            Swal.fire({
                                heightAuto: false,
                                text: `Do you want to disable data back-up every hour?`,
                                showConfirmButton: true,
                                confirmButtonText: "Yes",
                                showDenyButton: true,
                                denyButtonText: "No",
                                confirmButtonColor: '#000',
                                denyButtonColor: '#e27d81',
                                icon: "question",
                                reverseButtons: true
                            })
                            .then(async(value) => {
                                if(value.isConfirmed){
                                    exportIntervalBtnEl.removeClass("selected")
                                    exportIntervalIsActive = await false
                                    setTimeout(()=>{
                                        saveJSON(exportIntervalIsActive,"exportIntervalIsActive")
                                    },0)
                                }
                            })
                        } else {
                            Swal.fire({
                                heightAuto: false,
                                text: `Do you want to enable data Back-Up every hour?`,
                                showConfirmButton: true,
                                confirmButtonText: "Yes",
                                showDenyButton: true,
                                denyButtonText: "No",
                                confirmButtonColor: '#000',
                                denyButtonColor: '#e27d81',
                                icon: "question",
                                reverseButtons: true
                            })
                            .then(async(value) => {
                                if(value.isConfirmed){
                                    exportIntervalBtnEl.addClass("selected")
                                    exportIntervalIsActive = await true
                                    exportIntervalStartDate = await exportIntervalStartDate || new Date()
                                    if((new Date).getTime()-(exportIntervalStartDate.getTime())>3600000){// 1hrs
                                        await new Promise(async(resolve)=>{
                                            await menuContainerEl.fadeOut(250)
                                            resolve()
                                        }).then(async()=>{
                                            if(!willAutoUpdate){
                                                dataStatusPrio = true
                                                dataStatusSpinnerHomeEl.show()
                                                dataStatusEl
                                                    .empty()
                                                    .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                                await backUpData()
                                            }
                                            // Interval
                                            if(!exportIntervalTimeout.length){
                                                let saveExportIntervalTimeout = setInterval(async()=>{
                                                    setTimeout(async()=>{
                                                        if(!willAutoUpdate){
                                                            dataStatusPrio = true
                                                            dataStatusSpinnerHomeEl.show()
                                                            dataStatusEl
                                                                .empty()
                                                                .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                                            await backUpData()
                                                        }
                                                    },1000)
                                                },3600000)
                                                exportIntervalTimeout.push(saveExportIntervalTimeout)
                                            }
                                        })
                                    } else {
                                        // Timeout
                                        setTimeout(async()=>{
                                            setTimeout(async()=>{
                                                if(!willAutoUpdate){
                                                    dataStatusPrio = true
                                                    dataStatusSpinnerHomeEl.show()
                                                    dataStatusEl
                                                        .empty()
                                                        .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                                    await backUpData()
                                                }
                                                // Interval
                                                if(!exportIntervalTimeout.length){
                                                    let saveExportIntervalTimeout = setInterval(async()=>{
                                                        setTimeout(async()=>{
                                                            if(!willAutoUpdate){
                                                                dataStatusPrio = true
                                                                dataStatusSpinnerHomeEl.show()
                                                                dataStatusEl
                                                                    .empty()
                                                                    .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                                                await backUpData()
                                                            }
                                                        },1000)
                                                    },3600000)
                                                    exportIntervalTimeout.push(saveExportIntervalTimeout)
                                                }
                                            },1000)
                                        },3600000-((new Date).getTime()-(exportIntervalStartDate.getTime())))
                                    }
                                    setTimeout(()=>{
                                        saveJSON(exportIntervalIsActive,"exportIntervalIsActive")
                                        saveJSON(exportIntervalStartDate,"exportIntervalStartDate")
                                    },0)
                                }
                            })
                        }
                    // Android
                    } else {
                        console.log("WebtoApp: Choose an Export Path")
                    }
                    // Android
                })
                // Android
                $("#chooseExportPathBtn").on("click",()=>{
                    if(exportPathIsAvailable) {
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to change your folder for export?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then(async(value) => {
                            if(value.isConfirmed){
                                console.log("WebtoApp: Choose an Export Path")
                            }
                        })
                    } else {
                        // Android has the confirmation here
                        console.log("WebtoApp: Choose an Export Path")
                    }
                })
                // Android
                $("#warnAnimeBtn").on("click", async ()=>{
                    await warnAnimeContainerEl.show()
                    warnAnimeModalEl.removeClass("swal2-hide-custom").addClass("swal2-show-custom").show()
                    let flex1El = await $("ul.flex1")
                    flex1El.animate({scrollTop: -Number.MAX_SAFE_INTEGER},1)
                    flex1El[0]?.scroll(0, -Number.MAX_SAFE_INTEGER)
                })
                $("#submitWarnAnime").on("click",async()=>{
                    savedWarnAnime = await $("ul.flex1>.value>.text").toArray()?.map((e)=>e.textContent)??[]
                    await warnAnimeModalEl.removeClass("swal2-show-custom").addClass("swal2-hide-custom")
                    setTimeout(()=>{
                        warnAnimeContainerEl.hide()
                    },300)
                    await saveJSON(savedWarnAnime,"savedWarnAnime")
                    menuContainerEl.fadeOut(250)
                    await LoadData()
                })
                $("#warnAnimeContainer, #cancelWarnAnime").on("click",async()=>{
                    warnAnimeModalEl.removeClass("swal2-show-custom").addClass("swal2-hide-custom")
                    setTimeout(async()=>{
                        warnAnimeContainerEl.hide()
                    },300)
                })
                $("#warnAnimeContainer, .swal2-modal-custom").on("click",(e)=>{
                    e.stopImmediatePropagation()
                })
                $("#filterAlgoBtn").on("click", async ()=>{
                    await filterAlgoContainerEl.show()
                    filterAlgoModalEl.removeClass("swal2-hide-custom").addClass("swal2-show-custom").show()
                    let flex2El = await $("ul.flex2")
                    flex2El.animate({scrollTop: -Number.MAX_SAFE_INTEGER},1)
                    flex2El[0]?.scroll(0, -Number.MAX_SAFE_INTEGER)
                })
                $("#submitFilterAlgo").on("click",async()=>{
                    if(!haveSavedUserList){
                        Swal.fire({
                            heightAuto: false,
                            text: `You need to update first or add score an anime in Anilist before using this Feature!`,
                            showConfirmButton: true,
                            confirmButtonText: "Update",
                            showDenyButton: true,
                            denyButtonText: "Later",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "info",
                            reverseButtons: true
                        }).then((value)=>{
                            if(value.isConfirmed){
                                filterAlgoModalEl.removeClass("swal2-show-custom").addClass("swal2-hide-custom")
                                setTimeout(()=>{
                                    filterAlgoContainerEl.hide()
                                },300)
                                Update(true)
                                menuContainerEl.fadeOut(250)
                                for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                                dataStatusSpinnerHomeEl.hide()
                                let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                                dataStatusEl
                                    .empty()
                                    .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                                    .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                            }
                        })
                        return
                    } else {
                        savedFilterAlgo = await $("ul.flex2>.value>.text").toArray()?.map((e)=>e.textContent)??[]
                        filterAlgoValidationEl
                            .removeClass("success-before")
                            .addClass("no-before")
                            .css({display:"flex"})
                            .html(
                                `<div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                                    <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                    <div>Analyzing Variables...</div>
                                </div>`
                            )
                        Update(false)
                    }
                })
                $("#filterAlgoContainer, #cancelFilterAlgo").on("click",async()=>{
                    filterAlgoModalEl.removeClass("swal2-show-custom").addClass("swal2-hide-custom")
                    setTimeout(async()=>{
                        filterAlgoContainerEl.hide()
                    },300)
                })
                $("#filterAlgoContainer, .swal2-modal-custom").on("click",(e)=>{
                    e.stopImmediatePropagation()
                })
                $("#sign-up").on("click", async ()=>{
                    Swal.fire({
                        heightAuto: false,
                        text: `Do you want to create an Anilist account?`,
                        showConfirmButton: true,
                        confirmButtonText: "Yes, Signup",
                        showDenyButton: true,
                        denyButtonText: "No",
                        confirmButtonColor: '#000',
                        denyButtonColor: '#e27d81',
                        icon: "question",
                        reverseButtons: true
                    }).then(async(value)=>{
                        if(value.isConfirmed){
                            await window.open('https://anilist.co/signup', '_blank')
                            if(!requestIsRunning){
                                const { value: username } = await Swal.fire({
                                    heightAuto: false,
                                    text: "Done signing-up your new account with Anilist? Update with your new username to load your own data.",
                                    input: 'text',
                                    inputLabel: 'Enter your Anilist Username:',
                                    customClass: {
                                        icon: 'no-border'
                                    },
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                    showConfirmButton: true,
                                    confirmButtonText: "Update",
                                    confirmButtonColor: '#000',
                                    showDenyButton: true,
                                    denyButtonColor: '#e27d81',
                                    denyButtonText: "Cancel",
                                    reverseButtons: true,
                                    inputValidator: async(value) => {
                                        return await new Promise(async(resolve) => {
                                            if(!value) {
                                                resolve("You need to write Something...")
                                            } else {
                                                let UsernameValidationEl = await $("#UsernameValidation")
                                                $.ajax({
                                                    type: 'POST',
                                                    url: 'https://graphql.anilist.co',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'Accept': 'application/json',
                                                        'Cache-Control': 'max-age=31536000, immutable'
                                                    },
                                                    dataType: 'json',
                                                    data: JSON.stringify({
                                                        query: `{User(name:"${value}"){name}}`
                                                    }),
                                                    beforeSend: () => {
                                                        $(".swal2-validation-message")
                                                            .addClass("no-before")
                                                            .css({display:"flex"})
                                                            .html(
                                                                `<div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                                                                    <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                                                    <div>Checking Username...</div>
                                                                </div>`
                                                            )
                                                    },
                                                    success: (data) => {
                                                        initStartTime = undefined
                                                        setTimeout(()=>{
                                                            saveJSON(initStartTime,"initStartTime")
                                                        },0)
                                                        UsernameValidationEl.fadeOut(1000,()=>{
                                                            UsernameValidationEl.remove()
                                                            $(".swal2-validation-message")
                                                                .addClass("no-before").removeClass("no-before")
                                                                .addClass("success-before")
                                                                .html("User has been Found")
                                                            setTimeout(()=>{
                                                                // Reset Custom Validation
                                                                filterAlgoValidationEl.html("").hide()
                                                                resolve()
                                                            },1000)
                                                        })
                                                    },
                                                    error: (xhr) =>{
                                                        if(!window.navigator.onLine){
                                                            if((Math.floor(new Date()-initStartTime)>60000)||initStartTime===undefined){
                                                                initStartTime = new Date()
                                                                setTimeout(()=>{
                                                                    saveJSON(initStartTime,"initStartTime")
                                                                },0)
                                                            }
                                                            UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                                            resolve("Unable to connect to the Internet")
                                                        } else if(xhr?.responseJSON?.errors?.[0]?.message==='Not Found.'){
                                                            initStartTime = undefined
                                                            UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                                            setTimeout(()=>{
                                                                saveJSON(initStartTime,"initStartTime")
                                                            },0)
                                                            resolve("Username not Found, Please Try Again...")
                                                        } else {
                                                            if((Math.floor(new Date()-initStartTime)>60000)||initStartTime===undefined){
                                                                initStartTime = new Date()
                                                                setTimeout(()=>{
                                                                    saveJSON(initStartTime,"initStartTime")
                                                                },0)
                                                            }
                                                            UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                                            resolve(`An Error Occured, Please Try Again in ${msToTime(Math.max(60000-(new Date()-initStartTime),1000))}`)
                                                        }
                                                    }
                                                })
                                            }
                                        })
                                    }
                                })
                                if(username){
                                    await usernameEl.val(username)
                                    Update(true)
                                }
                            }
                        }
                    })
                })
                themeBtnEl.on("click", async ()=>{
                    if(savedTheme==="darkMode"){
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to change your theme to light mode?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        }).then(async(value)=>{
                            if(value.isConfirmed){
                                let prevTheme = await savedTheme
                                savedTheme = await "lightMode"
                                themeBtnEl.removeClass("selected")
                                menuContainerEl.fadeOut(250)
                                await LoadData()
                                await loadTheme(savedTheme,prevTheme)
                                setTimeout(()=>{
                                    saveJSON(savedTheme,"savedTheme")
                                },0)
                            }
                        })
                    } else {
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to change your theme to dark mode?`,
                            showConfirmButton: true,
                            confirmButtonText: "Yes",
                            showDenyButton: true,
                            denyButtonText: "No",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        }).then(async(value)=>{
                            if(value.isConfirmed){
                                let prevTheme = await savedTheme
                                savedTheme = await "darkMode"
                                themeBtnEl.addClass("selected")
                                menuContainerEl.fadeOut(250)
                                await LoadData()
                                await loadTheme(savedTheme,prevTheme)
                                setTimeout(()=>{
                                    saveJSON(savedTheme,"savedTheme")
                                },0)
                            }
                        })
                    }
                })
                hideKidsAnimeBtnEl.on("click", async ()=>{
                    if(kidsAnimeIsHidden){
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to show all anime with Kids tag?`,
                            showConfirmButton: true,
                            confirmButtonText: "Show",
                            showDenyButton: true,
                            denyButtonText: "Cancel",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then((value)=>{
                            if(value.isConfirmed){
                                kidsAnimeIsHidden = false
                                hideKidsAnimeBtnEl.removeClass("selected")
                                setTimeout(()=>{
                                    saveJSON(kidsAnimeIsHidden,"kidsAnimeIsHidden")
                                },0)
                                menuContainerEl.fadeOut(250)
                                LoadData()
                            }
                        })
                    } else {
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to hide all anime with Kids tag?`,
                            showConfirmButton: true,
                            confirmButtonText: "Hide",
                            showDenyButton: true,
                            denyButtonText: "Cancel",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then((value)=>{
                            if(value.isConfirmed){
                                kidsAnimeIsHidden = true
                                hideKidsAnimeBtnEl.addClass("selected")
                                setTimeout(()=>{
                                    saveJSON(kidsAnimeIsHidden,"kidsAnimeIsHidden")
                                },0)
                                menuContainerEl.fadeOut(250)
                                LoadData()
                            }
                        })
                    }
                })
                hideUnwatchedSequelsBtnEl.on("click", async ()=>{
                    if(hideUnwatchedSequels){
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to show all unwatched-Animes' sequels?`,
                            showConfirmButton: true,
                            confirmButtonText: "Show",
                            showDenyButton: true,
                            denyButtonText: "Cancel",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then((value)=>{
                            if(value.isConfirmed){
                                hideUnwatchedSequels = false
                                hideUnwatchedSequelsBtnEl.removeClass("selected")
                                Update(false)
                                menuContainerEl.fadeOut(250)
                            }
                        })
                    } else {
                        Swal.fire({
                            heightAuto: false,
                            text: `Do you want to hide all unwatched-Animes' sequels?`,
                            showConfirmButton: true,
                            confirmButtonText: "Hide",
                            showDenyButton: true,
                            denyButtonText: "Cancel",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#e27d81',
                            icon: "question",
                            reverseButtons: true
                        })
                        .then((value)=>{
                            if(value.isConfirmed){
                                hideUnwatchedSequels = true
                                hideUnwatchedSequelsBtnEl.addClass("selected")
                                Update(false)
                                menuContainerEl.fadeOut(250)
                            }
                        })
                    }
                })
                animeRecommendationListEl.delegate('td.anime-score', 'click' , async function() {
                    let warns = $(this).children("div").children("div").attr("title")
                    if(warns){
                        await Swal.fire({
                            heightAuto: false,
                            text: `Content Warning, Anime has the following contents: \n${warns}`,
                            icon: "info",
                            confirmButtonColor: "#000",
                            customClass: {
                                container: 'whitespace-pre-wrap'
                            }
                        })
                    }
                })
                // Android
                $("#restart").on('click', ()=>{
                    Swal.fire({
                        heightAuto: false,
                        text: `Do you want to restart the app?`,
                        showConfirmButton: true,
                        confirmButtonText: "Yes",
                        showDenyButton: true,
                        denyButtonText: "No",
                        confirmButtonColor: '#000',
                        denyButtonColor: '#e27d81',
                        icon: "question",
                        reverseButtons: true
                    })
                    .then(async(value) => {
                        if(value.isConfirmed){
                            window.location.href=window.location.href
                        }
                    })
                })
                // Android
                $(".anime-table-headers").on('click', ()=>{
                    let savedSort = animeTableEl[0]?.config?.sortList?.[0]
                    if(savedSort instanceof Array){
                        setTimeout(()=>{
                            saveJSON(savedSort,"savedSort")
                        },0)
                    }
                    setTimeout(()=>{
                        pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                    },1)
                })
                pageNumberOptionsEl.on('change',()=>{
                    setTimeout(()=>{
                        pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                    },1)
                })
                $(".filter-container, .filter-container-custom").on('DOMNodeInserted','.flexdatalist-multiple',()=>{
                    if(savedTheme==="darkMode"){
                        $(` .flexdatalist-multiple,
                            .flexdatalist-alias,
                            .flexdatalist-results,
                            .flexdatalist-multiple > .value
                        `).addClass('darkMode')
                    }
                })
                bodyEl.on('DOMNodeInserted','.swal2-popup, .swal2-popup-custom, .swal2-container',()=>{
                    if(savedTheme==="darkMode"){
                        $(` .swal2-confirm,
                            .swal2-confirm-custom,
                            .swal2-footer > a,
                            .swal2-popup,
                            .swal2-popup-custom,
                            .swal2-validation-message
                        `).addClass('darkMode')
                        // Observe Attribute Change
                        let swalValMes = document.getElementById("swal2-validation-message")
                        if(swalValMes){
                            let observed = new MutationObserver((mutations)=>{
                                let classList = mutations[0]?.target?.classList ?? []
                                if(!classList.contains("darkMode")){
                                    classList.add("darkMode")
                                } else {
                                    return
                                }
                            })
                            observed.observe(document.getElementById("swal2-validation-message"),{attributes:true})
                        }
                    }
                })
                bodyEl.on('DOMNodeInserted','.flexdatalist-results',()=>{
                    if(savedTheme==="darkMode"){
                        $(".flexdatalist-results").addClass('darkMode')
                    }
                })
                $(".filter-container-custom, .filter-container").on('DOMNodeInserted','li.value',()=>{
                    if(savedTheme==="darkMode"){
                        $(".flexdatalist-multiple > .value").addClass('darkMode')
                    }
                })
                bodyEl.on('scroll', function () {
                    setTimeout(async()=>{
                        saveJSON(bodyEl.scrollTop()||0,"savedYscroll")
                    },1)
                })
                $(window).on("keydown", (e) => {
                    if(!$("input").is(':focus')&&!isLoading){
                        let evtobj = window.event? event : e
                        let keyCode = evtobj.which || evtobj.keyCode || 0
                        if(keyCode===37){//left arrow
                            if(evtobj.ctrlKey){
                                $("#first").click()
                            } else {
                                $("#prev").click()
                            }
                        } else if(keyCode===39){//right arrow
                            if(evtobj.ctrlKey){
                                $("#last").click()
                            } else {
                                $("#next").click()
                            }
                        } else if(keyCode===83&&evtobj.ctrlKey){
                            e.preventDefault()
                            dataStatusEl.click()
                        }
                    }
                })
                $(window).on("resize", (e) => {
                    if(screen.availHeight>=screen.availWidth){
                        if(maxClientHeight<window.outerHeight){
                            maxClientHeight = window.outerHeight
                        }
                        // Avoid unchanged resizes, and allow height gaps for other devices
                        if(window.outerHeight>=maxClientHeight*0.75){
                            setTimeout(()=>{
                                pagerEl.css({position: "fixed"})
                            },100)
                        } else {
                            pagerEl.css({position: "static"})
                        }
                    }
                })
                window.addEventListener('scroll',()=>{
                    if(!isScrolling) isScrolling = true
                    clearTimeout(scrollTimeout)
                    scrollTimeout = setTimeout(()=>{
                        isScrolling = false
                    },500)
                        if(screen.availHeight>=screen.availWidth&&window.outerHeight>=window.outerWidth){
                            if(maxClientHeight<window.outerHeight){
                                maxClientHeight = window.outerHeight
                            }
                            if(window.outerHeight>=maxClientHeight*0.75){ // Extra Space for Other Device/Browser
                                setTimeout(()=>{
                                    pagerEl.css({position: "fixed"})
                                },100)
                            }
                        } else {
                            setTimeout(()=>{
                                pagerEl.css({position: "fixed"})
                            },100)
                        }
                }, true)
                $("body").on("focusin","input",(e) => {
                        e.stopPropagation()
                        pagerEl.css({position: "static"})
                }).on("focusout","input",() => {
                        setTimeout(()=>{
                            if(!$("input").is(":focus")){
                                pagerEl.css({position: "fixed"})
                            }
                        },100)
                })
                let timeoutId = 0
                $(document).on('touchstart','.copy-value',(e)=> {
                    timeoutId = setTimeout(()=>{
                        let target = $(e.target)
                        target.css('pointer-events','none')
                        let text = target.data("copy-value")
                        if((text??'')!==''&&!isScrolling){
                            // Android
                            copyToClipBoard(text)
                            // Android
                        }
                    }, 1000)
                }).on('touchend touchcancel','.copy-value',(e)=>{
                    setTimeout(()=>{
                        $(e.target).css('pointer-events','')
                    },750)
                    clearTimeout(timeoutId)
                })
                resolve()
            })
        }).then(async()=>{
            return await new Promise(async(resolve)=>{
                // Initial SavedTheme
                await loadTheme(savedTheme)
                resolve()
            })
        }).then(async()=>{
            // Init Modules/Config/Functions
            return await new Promise(async(resolve)=>{
                // Jquery Table Sorter
                await animeTableEl
                    .tablesorter({
                        sortInitialOrder: "asc",
                        headers: {
                            1:{sortInitialOrder: "desc"},
                            4:{sortInitialOrder: "desc"},
                            9:{sortInitialOrder: "desc"},
                        },
                        widgets: ["saveSort"],
                        widgetOptions : {
                            saveSort : true
                        }
                    })
                    .tablesorterPager({
                        container: pagerEl,
                        updateArrows: true,
                        page: (savedTableStatus==="Unhidden"? savedUnhiddenTablePage:savedHiddenTablePage),
                        savePages: true,
                        size: 8,
                        pageReset: false,
                        removeRows: true,
                        cssNext: '.next',
                        cssPrev: '.prev',
                        cssFirst: '.first',
                        cssLast: '.last',
                        cssGoto: '.pagenum',
                        cssPageDisplay: '.pagedisplay'
                    })
                    .delegate('.hide-anime', 'click' , async(e) => {
                        if(!isRunning){
                            isRunning = true
                            let hiddenRow = await $(e.currentTarget).closest('tr') || $(e.target).closest('tr')
                            let hiddenAnimeID = await hiddenRow.children(".animeTitle").children(".td-container").children("a").attr("data-value")
                            await hiddenRow.html(`
                                <tr class="item ${savedTheme}" role="row">
                                    <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                                        <div style="display:flex; align-items:center;">
                                            <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                            <div>Removing...</div>
                                        </div>
                                    </td>
                                </tr>
                            `)
                            await hiddenRow.addClass("remove-me")
                            if(animeTableEl[0]?.config?.rowsCopy?.length===0){
                                await animeRecommendationListEl.empty()
                                await animeRecommendationListEl.append(`
                                    <tr class="item ${savedTheme}" role="row">
                                        <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                                            <i class="fa fa-solid fa-file fa-xl" style="padding-right: 1ch;"></i>
                                            No Data
                                        </td>
                                    </tr>
                                `)
                            }
                            savedHiddenAnimeIDs[hiddenAnimeID] = await true
                            setTimeout(()=>{
                                saveJSON(savedHiddenAnimeIDs,"savedHiddenAnimeIDs")
                            },0)
                            animeTableEl.trigger("pagerUpdate")
                            // Have a Hidden Anime
                            if(await !jsonIsEmpty(savedHiddenAnimeIDs)){
                                await showAllAnimeBtnEl.show()
                            }
                            await pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                            isRunning = false
                        } else isRunning = false
                    })
                    .delegate('.show-anime', 'click' , async(e) => {
                        if(!isRunning){
                            isRunning = true
                            let hiddenRow = await $(e.currentTarget).closest('tr') || $(e.target).closest('tr')
                            let hiddenAnimeID = await hiddenRow.children(".animeTitle").children(".td-container").children("a").attr("data-value")
                            await hiddenRow.html(`
                                <tr class="item ${savedTheme}" role="row">
                                    <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                                        <div style="display:flex; align-items:center;">
                                            <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                            <div>Removing...</div>
                                        </div>
                                    </td>
                                </tr>
                            `)
                            await hiddenRow.addClass("remove-me")
                            animeTableEl.trigger("pagerUpdate")
                            await delete savedHiddenAnimeIDs[hiddenAnimeID]
                            setTimeout(()=>{
                                saveJSON(savedHiddenAnimeIDs,"savedHiddenAnimeIDs")
                            },0)
                            // No Hidden Anime
                            if(await jsonIsEmpty(savedHiddenAnimeIDs)||animeTableEl[0]?.config?.rowsCopy?.length===0){
                                await animeRecommendationListEl.empty()
                                animeRecommendationListEl.append(`
                                    <tr class="item ${savedTheme}" role="row">
                                        <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                                            <i class="fa fa-solid fa-file fa-xl" style="padding-right: 1ch;"></i>
                                            No Data
                                        </td>
                                    </tr>
                                `)
                                await showAllAnimeBtnEl.hide()
                            }
                            await pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                            isRunning = false
                        } else isRunning = false
                    })
                    .bind('pageMoved', async() => {
                        await pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                        let page = await animeTableEl[0]?.config?.pager?.page
                        await ++page
                        if(savedTableStatus==="Unhidden"){
                            savedUnhiddenTablePage = await page || 1
                            setTimeout(()=>{
                                saveJSON(savedUnhiddenTablePage,"savedUnhiddenTablePage")
                            },0)
                        } else if(savedTableStatus==="Hidden"){
                            savedHiddenTablePage = await page || 1
                            setTimeout(()=>{
                                saveJSON(savedHiddenTablePage,"savedHiddenTablePage")
                            },0)
                        }
                    })
                // Flex DataList
                await $(".flexdatalist").flexdatalist({})
                await $(".flexdatalistWarnAnime").flexdatalist({})
                await $(".flexdatalistFilterAlgo").flexdatalist({})
                resolve()
            })
        }).then(async()=>{
            // Init Backup Data
            return await new Promise(async(resolve)=>{
                if(savedBackUpVersion<backUpVersion){
                    savedAnalyzeVariableTime = await [15]
                    savedUpdateAnalyzeAnimeTime = await [15]
                    savedDeepUpdateTime = await [6700]
                    await saveJSON(savedAnalyzeVariableTime,"savedAnalyzeVariableTime")
                    await saveJSON(savedUpdateAnalyzeAnimeTime,"savedUpdateAnalyzeAnimeTime")
                    await saveJSON(savedDeepUpdateTime,"savedDeepUpdateTime")
                    resolve()
                } else {
                    resolve()
                }
            })
        }).then(async()=>{
            return await new Promise(async(resolve)=>{
                if(!haveSavedAnimeEntries||lastSavedUpdateTime===0||savedBackUpVersion<backUpVersion){
                    let worker0 = await new Worker(`./js-css/worker/getAnimeEntries-${version}.js`)
                    await worker0.postMessage("")
                    worker0.onmessage = async ({data}) => {
                        // data == lastSavedUpdate Time in backUp
                        if(data>lastSavedUpdateTime||!haveSavedAnimeEntries){
                            lastSavedUpdateTime = data
                            haveSavedAnimeEntries = true
                        }
                        if(savedUsername){
                            versionUpdate = await true
                            await saveJSON(versionUpdate,"versionUpdate")
                            if(usernameEl.val()){
                                Update(false)
                            }
                        }
                        resolve()
                    }
                    worker0.onerror = (error) => {
                        worker0.terminate()
                        console.error(error)
                        resolve()
                    }
                } else {
                    resolve()
                }
            })
        }).then(async()=>{
            return await new Promise(async(resolve)=>{
                if(await savedFilterOptionsJson.length<1||savedBackUpVersion<backUpVersion){
                    let worker1 = await new Worker(`./js-css/worker/getOptions-${version}.js`)
                    await worker1.postMessage("")
                    worker1.onmessage = async ({data}) => {
                        // data == savedFilterOptionsJson Time in backUp
                        savedFilterOptionsJson = await data || []
                        await $(".flexdatalist").flexdatalist({
                            minLength: 0,
                            searchIn: 'info',
                            data: savedFilterOptionsJson
                        })
                        resolve()
                    }
                    worker1.onerror = async (error) => {
                        worker1.terminate()
                        console.error(error)
                        resolve()
                    }
                } else {
                    await $(".flexdatalist").flexdatalist({
                        minLength: 0,
                        searchIn: 'info',
                        data: savedFilterOptionsJson
                    })
                    resolve()
                }
            })
        }).then(async()=>{
            return await new Promise(async(resolve)=>{
                if(savedBackUpVersion<backUpVersion){
                    savedFilters = ["limit top wscore: 100", "!top similarities: !staffs", "!user status: !completed", "!user status: !dropped"]
                    await saveJSON(savedFilters,"savedFilters")
                    resolve()
                } else {
                    resolve()
                }
            })
        }).then(async()=>{
            return await new Promise(async(resolve)=>{
                if(savedBackUpVersion<backUpVersion){
                    let worker2 = await new Worker(`./js-css/worker/getAnimeFranchises-${version}.js`)
                    await worker2.postMessage("")
                    worker2.onmessage = async (message) => {
                        resolve()
                    }
                    worker2.onerror = (error) => {
                        worker2.terminate()
                        console.error(error)
                        resolve()
                    }
                } else {
                    resolve()
                }
            })
        }).then(async()=>{
            // Apply Saved Data
            return await new Promise(async(resolve) => {
                // Reload Name
                if(savedUsername){
                    await usernameEl.val(savedUsername)
                    await updateIntervalBtnEl.show()
                } else {
                    setTimeout(()=>{
                        saveJSON({},"savedUserList")
                        saveJSON({},"savedUserScores")
                    },0)
                }
                // Reload Table Filters/Identifiers
                    // Table Filters
                let filterInput = await $("#flex0")
                for(let i=0; i<savedFilters.length; i++) {
                    await filterInput.val(savedFilters[i])
                    let e = await $.Event("keyup",{keyCode:13})
                    await filterInput.trigger(e)
                    await filterInput.val("")
                }
                    // Algorithm Filters
                let filterAlgoInput = await $("#flex2")
                for(let i=0; i<savedFilterAlgo.length; i++) {
                    await filterAlgoInput.val(savedFilterAlgo[i])
                    let e = await $.Event("keyup",{keyCode:13})
                    await filterAlgoInput.trigger(e)
                    await filterAlgoInput.val("")
                }
                await filterAlgoContainerEl.css({visibility:"visible"}).hide()
                    // Warn Content Identifier
                let warnAnimeInput = await $("#flex1")
                for(let i=0; i<savedWarnAnime.length; i++) {
                    await warnAnimeInput.val(savedWarnAnime[i])
                    let e = await $.Event("keyup",{keyCode:13})
                    await warnAnimeInput.trigger(e)
                    await warnAnimeInput.val("")
                }
                await warnAnimeContainerEl.css({visibility:"visible"}).hide()

                // Menu Filters
                if(await kidsAnimeIsHidden){
                    await hideKidsAnimeBtnEl.addClass("selected")
                }
                if(await hideUnwatchedSequels){
                    await hideUnwatchedSequelsBtnEl.addClass("selected")
                }
                if(await savedTheme==="darkMode"){
                    await themeBtnEl.addClass("selected")
                }
                if(await updateIntervalIsActive){
                    await updateIntervalBtnEl.addClass("selected")
                }
                if(await exportIntervalIsActive){
                    await exportIntervalBtnEl.addClass("selected")
                }

                // Init Last List (Unhidden/Hidden)
                let filters = await $("ul.flex0 > .value")
                await filters.children(".text").toArray()?.forEach(async(e,idx)=>{
                    if(e?.textContent?.toLowerCase()==="hidden"){
                        await hiddenUnhiddenBtnEl.text("Hidden")
                    }
                })

                // Load Last Saved Update
                dataStatusSpinnerHomeEl.hide()
                let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                dataStatusEl
                    .empty()
                    .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                    .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)

                // Load Table
                if(await !jsonIsEmpty(savedHiddenAnimeIDs)){
                    await showAllAnimeBtnEl.show()
                }
                await LoadData()
                resolve()
            })
        }).then(async()=>{
            // Update Saved DOM State
            return await new Promise(async(resolve)=>{
                await $.tablesorter.sortOn(animeTableEl[0]?.config, [savedSort])
                await pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                await bodyEl.animate({scrollTop: savedYscroll},1)
                let flex0El = await $("ul.flex0")
                let flex1El = await $("ul.flex1")
                let flex2El = await $("ul.flex2")
                flex0El.animate({scrollTop: Number.MAX_SAFE_INTEGER},1)
                flex1El.animate({scrollTop: -Number.MAX_SAFE_INTEGER},1)
                flex2El.animate({scrollTop: -Number.MAX_SAFE_INTEGER},1)
                // Only Works with SetTimeout >=1 in firefox idk why
                setTimeout(()=>{
                    flex0El[0]?.scroll(0, flex0El.outerHeight())
                },1)
                flex1El[0]?.scroll(0, -Number.MAX_SAFE_INTEGER)
                flex2El[0]?.scroll(0, -Number.MAX_SAFE_INTEGER)
                resolve()
            })
        }).then(async()=>{
            // Auto Intervals
            return await new Promise(async(resolve) => {
                // Auto Update
                if(await updateIntervalIsActive){
                    await updateIntervalBtnEl.addClass("selected")
                    updateIntervalStartDate = await updateIntervalStartDate || new Date()
                    if(await (new Date).getTime()-(updateIntervalStartDate.getTime())>3600000){// 1hr
                        if(!requestIsRunning&&usernameEl.val()){
                            if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                            willAutoUpdate = true
                            Update(true)
                        }
                        // Interval
                        if(!updateIntervalTimeout.length){
                            let saveUpdateIntervalTimeout = setInterval(async()=>{
                                if(!requestIsRunning){
                                    if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                    willAutoUpdate = true
                                    Update(true)
                                }
                            },3600000)
                            updateIntervalTimeout.push(saveUpdateIntervalTimeout)
                        }
                        resolve()
                    } else {
                        // Timeout
                        setTimeout(async()=>{
                            if(!requestIsRunning&&usernameEl.val()){
                                if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                willAutoUpdate = true
                                Update(true)
                            }
                            // Interval
                            if(!updateIntervalTimeout.length){
                                let saveUpdateIntervalTimeout = setInterval(async()=>{
                                    if(!requestIsRunning){
                                        if(await usernameEl.val()!==savedUsername) await usernameEl.val(savedUsername)
                                        willAutoUpdate = true
                                        Update(true)
                                    }
                                },3600000)
                                updateIntervalTimeout.push(saveUpdateIntervalTimeout)
                            }
                        },3600000-((new Date).getTime()-(updateIntervalStartDate.getTime())))
                        resolve()
                    }
                    setTimeout(()=>{
                        saveJSON(updateIntervalStartDate,"updateIntervalStartDate")
                    },0)
                } else {
                    resolve()
                }
            }).then(async()=>{
                // Auto Export
                if(exportIntervalIsActive){
                    await exportIntervalBtnEl.css("selected")
                    exportIntervalStartDate = await exportIntervalStartDate || new Date()
                    if(await ((new Date).getTime()-(exportIntervalStartDate.getTime())>3600000)){// 1hr
                        if(!willAutoUpdate){
                            dataStatusPrio = true
                            dataStatusSpinnerHomeEl.show()
                            dataStatusEl
                                .empty()
                                .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                            backUpData()
                        }
                        // Interval
                        if(!exportIntervalTimeout.length){
                            let saveExportIntervalTimeout = await setInterval(async()=>{
                                setTimeout(async()=>{
                                    if(!willAutoUpdate){
                                        dataStatusPrio = true
                                        dataStatusSpinnerHomeEl.show()
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                        backUpData()
                                    }
                                },1000)
                            },3600000)
                            await exportIntervalTimeout.push(saveExportIntervalTimeout)
                        }
                        return
                    } else {
                        // Timeout
                        setTimeout(async()=>{
                            setTimeout(async()=>{
                                if(!willAutoUpdate){
                                    dataStatusPrio = true
                                    dataStatusSpinnerHomeEl.show()
                                    dataStatusEl
                                        .empty()
                                        .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                    backUpData()
                                }
                                // Interval
                                if(!exportIntervalTimeout.length){
                                    let saveExportIntervalTimeout = await setInterval(async()=>{
                                        setTimeout(async()=>{
                                            if(!willAutoUpdate){
                                                dataStatusPrio = true
                                                dataStatusSpinnerHomeEl.show()
                                                dataStatusEl
                                                    .empty()
                                                    .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                                                backUpData()
                                            }
                                        },1000)
                                    },3600000)
                                    await exportIntervalTimeout.push(saveExportIntervalTimeout)
                                }
                            },1000)
                        },3600000-((new Date).getTime()-(exportIntervalStartDate.getTime())))
                        return
                    }
                    setTimeout(()=>{
                        saveJSON(exportIntervalStartDate,"exportIntervalStartDate")
                    },0)
                } else {
                    return
                }
            })
        }).then(async()=>{
            // Check if User Data is Updated
            if(versionUpdate&&savedUsername&&usernameEl.val()){
                Update(false)
            }
            // Save Back-Up Data Version Updates
            if(savedBackUpVersion<backUpVersion){
                setTimeout(()=>{
                    saveJSON(backUpVersion,"backUpVersion")
                },0)
                return
            } else {
                return
            }
            return
        }).then(async()=>{
            // Init New User
            if(!savedUsername){
                initUsernameData()
                return
            } else if(!haveSavedRecScheme){
                Update(true)
                return
            } else {
                return
            }
        }).then(async()=>{
            // Load Saved Theme
            return await new Promise(async(resolve)=>{
                await loadTheme(savedTheme)
                resolve()
            })
        }).then(async()=>{
            // Re-moval if fadeout failed
            setTimeout(()=>{
                let loader = $("#loader")
                if(loader.css("display")!=="none"){
                    loader.fadeOut(500)
                    setTimeout(()=>{
                        bodyEl.removeClass("noscroll")
                        htmlEl.removeClass("noscroll")
                    },500)
                    pageInits = false
                }
            },5000)
            // Limit Page Load to 3s
            const minimumLoadTime = 3000//ms
            const splitMS = Math.max((minimumLoadTime-((new Date().getTime())-pageLoadStartDate))/2,0)
            return await setTimeout(()=>{
                $("#loader").fadeOut(splitMS)
                setTimeout(()=>{
                    bodyEl.removeClass("noscroll")
                    htmlEl.removeClass("noscroll")
                },splitMS)
                pageInits = false
            },splitMS)
        })
    }

    // Main Functions
    function Update(anUpdate){
        let username = usernameEl.val()
        // Check Input Validity
        if(!username){
            usernameEl[0]?.setCustomValidity("Anilist Username is Required!")
            usernameEl[0]?.reportValidity()
        } else {
            // Start Update Request
            if(!requestIsRunning){
                requestIsRunning = true
            }
            let updateID = Math.random()
            while(updateIDs.includes(updateID)){
                updateID = Math.random()
            }
            updateIDs.push(updateID);
            // Reset Currently Running Updates
            if(worker3) worker3.terminate()
            if(worker4) worker4.terminate()
            if(worker5) worker5.terminate()
            analyzeVariables(updateID, username, anUpdate, versionUpdate, anUpdate?'init':'notAnUpdate')
        }
    }

    async function analyzeVariables(updateID, username, anUpdate, versionUpdate, returnInfo) {
        if(updateIDs.length>1&&updateID!==updateIDs.at(-1)){
            if(worker3) worker3.terminate()
            if(worker4) worker4.terminate()
            if(worker5) worker5.terminate()
            updateIDs = [updateIDs.at(-1)] // one line
            return
        }
        worker3 = new Worker(`./js-css/worker/analyzeVariable-${version}.js`)
        // Check Parameters
        worker3.postMessage({
            username: username,
            anUpdate: anUpdate,
            returnInfo: returnInfo,
            versionUpdate: versionUpdate,
            savedFilterAlgo: savedFilterAlgo
        })
        // Requests
        worker3.onmessage = async({data}) => {
            if(updateIDs.length>1&&updateID!==updateIDs.at(-1)){
                updateIDs = [updateIDs.at(-1)] // one line
                return
            }
            const status = data.status
            if(status==='notify'){
                let userListCount, updateStatus, needUpdate;
                if(updateStatus = data.updateStatus ?? false){
                    const info = updateStatus.info
                    const analyzeVariableTime = updateStatus.analyzeVariableTime
                    if(updateStatus.info==='normal'){
                        for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                        for(let i=analyzeVariableTime; i>=0; i--){
                            let timeout = setTimeout(()=>{
                                if(!dataStatusPrio){
                                    dataStatusSpinnerHomeEl.show()
                                    if(i<1){
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Analyzing your List... Please Wait a Moment...`)
                                    } else {
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Analyzing your List...⠀</span><span style="white-space:nowrap;">Estimated Time: ${msToTime(i*1000)}</span>`)
                                    }
                                }
                            },(analyzeVariableTime-i)*1000)
                            updateStateText.push(timeout)
                        }
                    } else if(updateStatus.info==='rateLimit'){
                        for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                        for(let i=60; i>=0; i--){
                            let timeout = setTimeout(()=>{
                                if(!dataStatusPrio){
                                    dataStatusSpinnerHomeEl.show()
                                    if(i<1){
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Rate Limit, Please Wait a Moment...`)
                                    } else {
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Rate Limit, Continuing in ${msToTime(i*1000)}`)
                                    }
                                }
                            },(60-i)*1000)
                            updateStateText.push(timeout)
                        }
                        setTimeout(()=>{
                            for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                            for(let i=analyzeVariableTime; i>=0; i--){
                                let timeout = setTimeout(()=>{
                                    if(!dataStatusPrio){
                                        dataStatusSpinnerHomeEl.show()
                                        if(i<1){
                                            dataStatusEl
                                                .empty()
                                                .append(`<span style="white-space:nowrap;">Analyzing your List... Please Wait a Moment...`)
                                        } else {
                                            dataStatusEl
                                                .empty()
                                                .append(`<span style="white-space:nowrap;">Analyzing your List...⠀</span><span style="white-space:nowrap;">Estimated Time: ${msToTime(i*1000)}</span>`)
                                        }
                                    }
                                },(analyzeVariableTime-i)*1000)
                                updateStateText.push(timeout)
                            }
                        },60000)
                    }
                } else if(userListCount = data.userListCount ?? false){
                    if(userListCount===0){
                        await Swal.fire({
                            heightAuto: false,
                            title: "Let us know you've liked...",
                            text: `To make your recommendations better, rate the anime you've already watched in your Anilist account for us to make an Analysis, you can also transfer your MAL List to Anilist.`,
                            showConfirmButton: true,
                            confirmButtonText: "Go to Anilist",
                            showDenyButton: true,
                            denyButtonText: "Import my MAL",
                            showCancelButton: true,
                            cancelButtonText: "Later",
                            confirmButtonColor: '#000',
                            denyButtonColor: '#2E51A2',
                            cancelButtonColor: '#e27d81',
                            icon: "info",
                            reverseButtons: true
                        })
                        .then(async(value) => {
                            if(value.isConfirmed){
                                window.open('https://anilist.co/search/anime', '_blank')
                                Swal.fire({
                                    heightAuto: false,
                                    title: "Let us know you've liked...",
                                    text: `If you're done rating an Anime, click update below or in the settings.`,
                                    showConfirmButton: true,
                                    confirmButtonText: "Update",
                                    showDenyButton: true,
                                    denyButtonText: "Cancel",
                                    confirmButtonColor: '#000',
                                    denyButtonColor: '#e27d81',
                                    icon: "info",
                                    reverseButtons: true
                                })
                                .then(async(value)=>{
                                    if(value.isConfirmed){
                                        Update(true)
                                    }
                                })
                            } else if(value.isDenied) {
                                malanilistImportExport()
                            }
                        })
                    } else if(userListCount>0&&userListCount<100) {
                        await Swal.fire({
                            heightAuto: false,
                            title: "Let us know you've liked...",
                            text: `You currently rated ≤${userListCount} unique anime in your Anilist account, a minimum of 30-100 will suffice the recommendation analysis.`,
                            showConfirmButton: true,
                            confirmButtonText: "Sure, Later",
                            showDenyButton: true,
                            denyButtonText: "Go to Anilist",
                            confirmButtonColor: '#e27d81',
                            denyButtonColor: '#000',
                            icon: "info",
                            reverseButtons: true
                        })
                        .then(async(value) => {
                            if(value.isDenied){
                                window.open('https://anilist.co/search/anime', '_blank');
                                Swal.fire({
                                    heightAuto: false,
                                    title: "Let us know you've liked...",
                                    text: `If you're done rating an Anime, click update below or in the settings.`,
                                    showConfirmButton: true,
                                    confirmButtonText: "Update",
                                    showDenyButton: true,
                                    denyButtonText: "Cancel",
                                    confirmButtonColor: '#000',
                                    denyButtonColor: '#e27d81',
                                    icon: "info",
                                    reverseButtons: true
                                })
                                .then(async(value)=>{
                                    if(value.isConfirmed){
                                        Update(true)
                                    }
                                })
                            }
                        })
                    }
                } else if(needUpdate = data.needUpdate ?? false){
                    Swal.fire({
                        heightAuto: false,
                        text: `You need to update first before using this Feature!`,
                        showConfirmButton: true,
                        confirmButtonText: "Update",
                        showDenyButton: true,
                        denyButtonText: "Later",
                        confirmButtonColor: '#000',
                        denyButtonColor: '#e27d81',
                        icon: "info",
                        reverseButtons: true
                    }).then((value)=>{
                        if(value.isConfirmed){
                            filterAlgoModalEl.removeClass("swal2-show-custom").addClass("swal2-hide-custom")
                            setTimeout(()=>{
                                filterAlgoContainerEl.hide()
                            },300)
                            Update(true)
                            menuContainerEl.fadeOut(250)
                            for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                            dataStatusSpinnerHomeEl.hide()
                            let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                            dataStatusEl
                                .empty()
                                .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                                .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                        }
                    })
                } else if(data.hideUnwatchedSequelsBtn!==undefined) {
                    if(hideUnwatchedSequelsBtn){
                        hideUnwatchedSequelsBtnEl.addClass("selected")
                    } else {
                        hideUnwatchedSequelsBtnEl.removeClass("selected")
                    }
                }
            } else if(status==='update'){
                if(data.savedAnalyzeVariableTime ?? false){
                    savedAnalyzeVariableTime = data.savedAnalyzeVariableTime
                } else if(data.haveSavedUserList!==undefined) {
                    haveSavedUserList = data.haveSavedUserList
                } else if(data.savedFilterAlgo ?? false) {
                    savedFilterAlgo = data.savedFilterAlgo
                } else if(data.hideUnwatchedSequels!==undefined) {
                    hideUnwatchedSequels = data.hideUnwatchedSequels
                }
            } else if(status==='analyzeAnime') {
                analyzeAnime(updateID, username, anUpdate, versionUpdate, returnInfo)
            } else if(status==='updateAnime'){
                updateAnime(updateID, username, anUpdate, versionUpdate, data.returnInfo)
            } else {// Errors
                let error = data.error
                for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                dataStatusSpinnerHomeEl.hide()
                let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                dataStatusEl
                    .empty()
                    .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                    .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                if(error==='Error 101: User Not Found'){
                    Swal.fire({
                        heightAuto: false,
                        text: `Username '${username}' was not found in Anilist. Do you want to create another Anilist account?`,
                        showConfirmButton: true,
                        confirmButtonText: "Yes, Signup",
                        showDenyButton: true,
                        denyButtonText: "No, Change it Back",
                        confirmButtonColor: '#000',
                        denyButtonColor: '#e27d81',
                        icon: "question",
                        reverseButtons: true
                    }).then(async(value)=>{
                        if(value.isConfirmed){
                            await window.open('https://anilist.co/signup', '_blank');
                            if(!requestIsRunning){
                                const { value: xusername} = await Swal.fire({
                                    heightAuto: false,
                                    text: "Done signing-up your new account with Anilist? Update with your new username or Return to the old username.",
                                    input: 'text',
                                    inputLabel: 'Enter your Anilist Username:',
                                    inputValue: username,
                                    customClass: {
                                        icon: 'no-border'
                                    },
                                    allowOutsideClick: false,
                                    allowEscapeKey: false,
                                    showConfirmButton: true,
                                    confirmButtonText: "Update",
                                    confirmButtonColor: '#000',
                                    showDenyButton: true,
                                    denyButtonColor: '#e27d81',
                                    denyButtonText: "Change it Back",
                                    reverseButtons: true,
                                    inputValidator: async(value) => {
                                        return await new Promise(async(resolve) => {
                                            let UsernameValidationEl = await $("#UsernameValidation")
                                            if(savedTheme==="darkMode"){
                                                $(".swal2-validation-message").addClass('darkMode')
                                            }
                                            if(!value) {
                                                resolve("You need to write Something...")
                                            } else {
                                                $.ajax({
                                                    type: 'POST',
                                                    url: 'https://graphql.anilist.co',
                                                    headers: {
                                                        'Content-Type': 'application/json',
                                                        'Accept': 'application/json',
                                                        'Cache-Control': 'max-age=31536000, immutable'
                                                    },
                                                    dataType: 'json',
                                                    data: JSON.stringify({
                                                        query: `{User(name:"${value}"){name}}`
                                                    }),
                                                    beforeSend: () => {
                                                        $(".swal2-validation-message")
                                                            .addClass("no-before")
                                                            .css({display:"flex"})
                                                            .html(
                                                                `<div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                                                                    <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                                                    <div>Checking Username...</div>
                                                                </div>`
                                                            )
                                                    },
                                                    success: (data) => {
                                                        initStartTime = undefined
                                                        setTimeout(()=>{
                                                            saveJSON(initStartTime,"initStartTime")
                                                        },0)
                                                        UsernameValidationEl.fadeOut(1000,()=>{
                                                            UsernameValidationEl.remove()
                                                            $(".swal2-validation-message")
                                                                .addClass("no-before").removeClass("no-before")
                                                                .addClass("success-before")
                                                                .html("Username Found")
                                                            setTimeout(()=>{
                                                                // Reset Custom Validation
                                                                filterAlgoValidationEl.html("").hide()
                                                                resolve()
                                                            },1000)
                                                        })
                                                    },
                                                    error: (xhr) =>{
                                                        if(!window.navigator.onLine){
                                                            if((Math.floor(new Date()-initStartTime)>60000)||initStartTime===undefined){
                                                                initStartTime = new Date()
                                                                setTimeout(()=>{
                                                                    saveJSON(initStartTime,"initStartTime")
                                                                },0)
                                                            }
                                                            UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                                            resolve("Unable to connect to the Internet")
                                                        } else if(xhr?.responseJSON?.errors?.[0]?.message==='Not Found.'){
                                                            initStartTime = undefined
                                                            setTimeout(()=>{
                                                                saveJSON(initStartTime,"initStartTime")
                                                            },0)
                                                            UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                                            resolve("Username not Found, Please Try Again...")
                                                        } else {
                                                            if((Math.floor(new Date()-initStartTime)>60000)||initStartTime===undefined){
                                                                initStartTime = new Date()
                                                                setTimeout(()=>{
                                                                    saveJSON(initStartTime,"initStartTime")
                                                                },0)
                                                            }
                                                            UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                                            resolve(`An Error Occured, Please Try Again in ${msToTime(Math.max(60000-(new Date()-initStartTime),1000))}`)
                                                        }
                                                    }
                                                })
                                            }
                                        })
                                    }
                                })
                                if(xusername){
                                    await usernameEl.val(xusername)
                                    Update(true)
                                } else {
                                    usernameEl.val(savedUsername)
                                }
                            }
                        } else if(value.isDenied){
                            usernameEl.val(savedUsername)
                        }
                    })
                } else if(status==='error'){
                    if(!window.navigator.onLine){
                        error = "Error 100: Unable to connect to the Internet!"
                    }
                    Swal.fire({
                        heightAuto: false,
                        text: error,
                        icon: "error",
                        confirmButtonColor: "#000"
                    })
                }
                console.error(error);
                (async()=>{
                    await LoadData()
                })();
                console.log("WebtoApp: Update Error")
                if(!haveSavedRecScheme){
                    animeRecommendationListEl.empty()
                    animeRecommendationListEl.append(`
                        <tr class="item ${savedTheme}" role="row">
                            <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                                <i class="fa fa-solid fa-file fa-xl" style="padding-right: 1ch;"></i>
                                No Data
                            </td>
                        </tr>
                    `)
                }
                requestIsRunning = false
                return
            }
        }
        worker3.onerror = (error) => {
            worker3.terminate()
            for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
            dataStatusSpinnerHomeEl.hide()
            let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
            dataStatusEl
                .empty()
                .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
            console.error(error)
            Swal.fire({
                heightAuto: false,
                text: "Error 115: Oops...Something went wrong! Please try again...",
                icon: "error",
                confirmButtonColor: "#000"
            })
        }
    }

    async function updateAnime(updateID, username, anUpdate, versionUpdate, returnInfo){
        if(updateIDs.length>1&&updateID!==updateIDs.at(-1)){
            if(worker3) worker3.terminate()
            if(worker4) worker4.terminate()
            if(worker5) worker5.terminate()
            updateIDs = [updateIDs.at(-1)] // one line
            return
        }
        if(worker4) worker4.terminate()
        worker4 = new Worker(`./js-css/worker/updateAnime-${version}.js`)
        worker4.postMessage({
            returnInfo: returnInfo
        })
        worker4.onmessage = ({data}) => {
            const status = data.status
            if(status==='notify'){
                let userListCount, updateStatus, needUpdate;
                if(updateStatus = data.updateStatus ?? false){
                    const info = updateStatus.info
                    const analyzeVariableTime = updateStatus.analyzeVariableTime
                    if(updateStatus.info==='normal'){
                        if(!dataStatusPrio){
                            for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                            dataStatusSpinnerHomeEl.hide()
                            dataStatusEl
                                .empty()
                                .append(updateStatus.message)
                        }
                    } else if(updateStatus.info==='rateLimit'){
                        const message = updateStatus.message
                        const loadPerc = message.loadPerc
                        const usDn = message.usDn
                        const usUp = message.usUp
                        for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                        for(let i=60; i>=0; i--){
                            let timeout = setTimeout(()=>{
                                if(!dataStatusPrio){
                                    dataStatusSpinnerHomeEl.hide()
                                    if(i<1){
                                        dataStatusEl
                                        .empty()
                                        .append(`<span style="white-space:nowrap;">Rate Limit, Please Wait a Moment:⠀</span><span style="white-space:nowrap;"><progress value="${usUp}" max="${usDn}"></progress>⠀${loadPerc}%</span>`)
                                    } else {
                                        dataStatusEl
                                            .empty()
                                            .append(`<span style="white-space:nowrap;">Rate Limit, Continuing in ${msToTime(i*1000)}:⠀</span><span style="white-space:nowrap;"><progress value="${usUp}" max="${usDn}"></progress>⠀${loadPerc}%</span>`)
                                    }
                                }
                            },(60-i)*1000)
                            updateStateText.push(timeout)
                        }
                    }
                }
            } else if(status==='update'){
                if(data.haveSavedAnimeEntries!==undefined){
                    haveSavedAnimeEntries = data.haveSavedAnimeEntries
                } else if(data.lastSavedUpdateTime ?? false) {
                    lastSavedUpdateTime = data.lastSavedUpdateTime
                }
            } else if(status==='analyzeVariables'){
                analyzeVariables(updateID, username, anUpdate, versionUpdate, data.returnInfo)
            } else if(status==='analyzeAnime'){
                analyzeAnime(updateID, username, anUpdate, versionUpdate, data.returnInfo)
            } else if(status==='error'){
                let error;
                if(!window.navigator.onLine){
                    error = "Error 100: Unable to connect to the Internet!"
                } else {
                    error = data.error
                }
                Swal.fire({
                    heightAuto: false,
                    text: error,
                    icon: "error",
                    confirmButtonColor: "#000"
                })
                requestIsRunning = false
                console.error(error)
                Swal.fire({
                    heightAuto: false,
                    text: error,
                    icon: "error",
                    confirmButtonColor: "#000"
                })
                LoadData()
                // Browser
                showNotification(`Oops...Something went wrong! Please try again...`);
                // Browser
                for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                dataStatusSpinnerHomeEl.hide()
                let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                dataStatusEl
                    .empty()
                    .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                    .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                console.log("WebtoApp: Update Error")
                if(!haveSavedRecScheme){
                    animeRecommendationListEl.empty()
                    animeRecommendationListEl.append(`
                        <tr class="item ${savedTheme}" role="row">
                            <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                                <i class="fa fa-solid fa-file fa-xl" style="padding-right: 1ch;"></i>
                                No Data
                            </td>
                        </tr>
                    `)
                }
            }
        }
        worker4.onerror = (error) => {
            worker4.terminate()
            requestIsRunning = false
            console.error(error)
            Swal.fire({
                heightAuto: false,
                text: "Error 111: Oops...Something went wrong! Please try again...",
                icon: "error",
                confirmButtonColor: "#000"
            })
            LoadData()
            for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
            dataStatusSpinnerHomeEl.hide()
            let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
            dataStatusEl
                .empty()
                .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
            console.log("WebtoApp: Update Error")
            if(!haveSavedRecScheme){
                animeRecommendationListEl.empty()
                animeRecommendationListEl.append(`
                    <tr class="item ${savedTheme}" role="row">
                        <td class="${savedTheme}" style="padding: 1.5em !important;" colspan="11">
                            <i class="fa fa-solid fa-file fa-xl" style="padding-right: 1ch;"></i>
                            No Data
                        </td>
                    </tr>
                `)
            }
        }
    }

    function analyzeAnime(updateID, username, anUpdate, versionUpdate, returnInfo){
        if(updateIDs.length>1&&updateID!==updateIDs.at(-1)){
            if(worker3) worker3.terminate()
            if(worker4) worker4.terminate()
            if(worker5) worker5.terminate()
            updateIDs = [updateIDs.at(-1)] // one line
            return
        }
        if(worker5) worker5.terminate()
        worker5 = new Worker(`./js-css/worker/analyzeAnime-${version}.js`)
        worker5.postMessage({
            updateID: updateID,
            username: username,
            anUpdate: anUpdate,
            returnInfo: returnInfo,
            versionUpdate: versionUpdate,
            hideUnwatchedSequels: hideUnwatchedSequels
        })
        worker5.onmessage = async({data}) => {
            if(updateIDs.length>1&&updateID!==updateIDs.at(-1)){
                updateIDs = [updateIDs.at(-1)] // one line
                return
            }
            const status = data.status
            if(status==='notify'){
                let updateAnalyzeAnimeTime, clearUpdateStatus, versionIsUpdated, newUsername, alertUser;
                if(updateAnalyzeAnimeTime = data.updateAnalyzeAnimeTime ?? false){
                    for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                    dataStatusSpinnerHomeEl.show()
                    for(let i=updateAnalyzeAnimeTime; i>=0; i--){
                        let timeout = setTimeout(async()=>{
                            if(!dataStatusPrio){
                                if(i<1){
                                    await dataStatusSpinnerHomeEl.show()
                                    await dataStatusEl
                                        .empty()
                                        .append(`<span style="white-space:nowrap;">Updating Recommendations List, Please Wait a Moment...`)
                                } else {
                                    await dataStatusEl
                                        .empty()
                                        .append(`<span style="white-space:nowrap;">Updating Recommendations List,⠀</span><span style="white-space:nowrap;">Estimated Time: ${msToTime(i*1000)}</span>`)
                                }
                            }
                        },(updateAnalyzeAnimeTime-i)*1000)
                        updateStateText.push(timeout)
                    }
                    // For Popup
                    if(!anUpdate){
                        filterAlgoValidationEl
                            .removeClass("success-before")
                            .addClass("no-before")
                            .css({display:"flex"})
                            .html(
                                `<div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                                    <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                    <div>Updating Recommendations List...</div>
                                </div>`
                            )
                    }
                } else if(clearUpdateStatus = data.clearUpdateStatus ?? false){
                    if(!anUpdate){
                        filterAlgoValidationEl
                            .addClass("no-before").removeClass("no-before")
                            .addClass("success-before")
                            .html("Filters have been applied")
                        setTimeout(()=>{
                            filterAlgoValidationEl.fadeOut(1000)
                        },1000)
                    }
                    for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                    dataStatusSpinnerHomeEl.hide()
                    let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                    dataStatusEl
                        .empty()
                        .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                        .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                } else if(alertUser = data.alertUser ?? false){
                    let filtersHasFocus = false
                    // Check input Focus before updating
                    if( $("#flex0").is(":focus")
                        ||$("#flex1").is(":focus")
                        ||$("#flex2").is(":focus")
                        ||warnAnimeContainerEl.css("display")!=="none"
                        ||filterAlgoContainerEl.css("display")!=="none"
                    ){
                        filtersHasFocus = true
                    }
                    console.log("WebtoApp: List is Updated")
                    if(!swal.isVisible()
                        &&!usernameEl.is(":focus")
                        &&!filtersHasFocus
                    ){
                        Swal.fire({
                            heightAuto: false,
                            text: "List has been updated!",
                            icon: "success",
                            confirmButtonColor: "#000"
                        })
                    }
                    // Browser
                    showNotification("List has been updated!")
                    // Browser
                    if(willAutoUpdate){
                        updateIntervalStartDate = new Date()
                        willAutoUpdate = false
                        setTimeout(()=>{
                            saveJSON(updateIntervalStartDate,"updateIntervalStartDate")
                        },0)
                    }
                    requestIsRunning = false
                }
            } else if(status==='update') {
                if(data.savedFilterOptionsJson ?? false) {
                    let filtersHasFocus = false
                    // Check input Focus before updating
                    if( $("#flex0").is(":focus")
                        ||$("#flex1").is(":focus")
                        ||$("#flex2").is(":focus")
                        ||warnAnimeContainerEl.css("display")!=="none"
                        ||filterAlgoContainerEl.css("display")!=="none"
                    ){
                        filtersHasFocus = true
                    }
                    // This Remove Current Filters in DOM so Check First
                    for(let i=0;i<checkFiltersFocus.length;i++) clearInterval(checkFiltersFocus[i])
                    let updateFiltersValid = setInterval(async()=>{
                        if( !$("#flex0").is(":focus")
                            &&!$("#flex1").is(":focus")
                            &&!$("#flex2").is(":focus")
                            &&warnAnimeContainerEl.css("display")==="none"
                            &&filterAlgoContainerEl.css("display")==="none"
                        ){
                            await clearInterval(updateFiltersValid)
                            // Get Current Value
                            let currentInputValue = await $("#flex0").val()
                            checkFiltersFocus = []
                            // Update
                            await $(".flexdatalist").flexdatalist({
                                data: data.savedFilterOptionsJson
                            })
                            // Reload Saved Table Filters
                            await new Promise(async(resolve)=>{
                                let filters = await $("ul.flex0 > .value")
                                await filters.children(".text").toArray()?.forEach(async(e,idx)=>{
                                    if(e?.textContent?.toLowerCase()==="hidden"){
                                        await $("#flex0").prop("disabled", true)
                                        await filters.eq(idx).children(".fdl-remove").trigger("click")
                                        await $("#flex0").prop("disabled", false)
                                    }
                                })
                                resolve()
                            }).then(async()=>{
                                let filterInput = await $("#flex0")
                                for(let i=0; i<savedFilters.length; i++) {
                                    await filterInput.val(savedFilters[i])
                                    let e = await $.Event("keyup",{keyCode:13})
                                    await filterInput.trigger(e)
                                    await filterInput.val("")
                                }
                                if(typeof currentInputValue==="string"){
                                    await filterInput.val(currentInputValue)
                                }
                                let flex0El = await $("ul.flex0")
                                await flex0El.animate({scrollTop: Number.MAX_SAFE_INTEGER},1)
                                await flex0El[0]?.scroll(0, flex0El.outerHeight())
                                return
                            })
                            // Reload Saved Algorithm Filters
                            if(filterAlgoContainerEl.css("display")!=="none"){
                                await filterAlgoContainerEl.css({visibility:"hidden"}).show()
                            }
                            await new Promise(async(resolve)=>{
                                let filterInfo = await $("ul.flex2 > .value")
                                await filterInfo.children(".text").toArray()?.forEach(async(e,idx)=>{
                                    await $("#flex2").prop("disabled", true)
                                    await filterInfo.eq(idx).children(".fdl-remove").trigger("click")
                                    await $("#flex2").prop("disabled", false)
                                })
                                resolve()
                            }).then(async()=>{
                                let filterAlgoInput = await $("#flex2")
                                for(let i=0; i<savedFilterAlgo.length; i++) {
                                    await filterAlgoInput.val(savedFilterAlgo[i])
                                    let e = await $.Event("keyup",{keyCode:13})
                                    await filterAlgoInput.trigger(e)
                                    await filterAlgoInput.val("")
                                }
                                await filterAlgoContainerEl.css({visibility:"visible"}).hide()
                                let flex2El = await $("ul.flex2")
                                await flex2El.animate({scrollTop: -Number.MAX_SAFE_INTEGER},1)
                                await flex2El[0]?.scroll(0, -Number.MAX_SAFE_INTEGER)
                                return
                            })
                            // Reload Warn Anime Contents
                            if(warnAnimeContainerEl.css("display")!=="none"){
                                await warnAnimeContainerEl.css({visibility:"hidden"}).show()
                            }
                            await new Promise(async(resolve)=>{
                                let warnInfo = await $("ul.flex1>.value")
                                await warnInfo.children(".text").toArray()?.forEach(async(e,idx)=>{
                                    await $("#flex1").prop("disabled", true)
                                    await warnInfo.eq(idx).children(".fdl-remove").trigger("click")
                                    await $("#flex1").prop("disabled", false)
                                })
                                resolve()
                            }).then(async()=>{
                                let warnAnimeInput = await $("#flex1")
                                for(let i=0; i<savedWarnAnime.length; i++) {
                                    await warnAnimeInput.val(savedWarnAnime[i])
                                    let e = await $.Event("keyup",{keyCode:13})
                                    await warnAnimeInput.trigger(e)
                                    await warnAnimeInput.val("")
                                }
                                await warnAnimeContainerEl.css({visibility:"visible"}).hide()
                                let flex1El = await $("ul.flex1")
                                await flex1El.animate({scrollTop: -Number.MAX_SAFE_INTEGER},1)
                                await flex1El[0]?.scroll(0, -Number.MAX_SAFE_INTEGER)
                                return
                            })
                            // Double Check
                            for(let i=0;i<checkFiltersFocus.length;i++) clearInterval(checkFiltersFocus[i])
                        }
                    },250)
                    checkFiltersFocus.push(updateFiltersValid)
                } else if(data.haveSavedRecScheme ?? false) {
                    haveSavedRecScheme = data.haveSavedRecScheme
                    if(haveSavedRecScheme) updateIntervalBtnEl.show()
                } else if(data.versionUpdate!==undefined){
                    versionUpdate = data.versionUpdate
                } else if(data.savedUsername ?? false){
                    savedUsername = data.savedUsername
                } else if(data.savedUpdateAnalyzeAnimeTime ?? false){
                    savedUpdateAnalyzeAnimeTime = data.savedUpdateAnalyzeAnimeTime
                } else if(data.savedDeepUpdateTime ?? false){
                    savedDeepUpdateTime = data.savedDeepUpdateTime
                }
            } else if(status==='loadData'){
                LoadData()
            } else if(status==='updateAnime'){
                updateAnime(updateID, username, anUpdate, versionUpdate, data.returnInfo)
            } else if(status==='notAnUpdate'){
                await new Promise(async(resolve)=>{
                    let algoFilters = await $("ul.flex2 > .value")
                    await algoFilters.children(".text").toArray()?.forEach(async(e,idx)=>{
                        await $("#flex2").prop("disabled", true)
                        await algoFilters.eq(idx).children(".fdl-remove").trigger("click")
                        await $("#flex2").prop("disabled", false)
                    })
                    resolve()
                }).then(async()=>{
                    let filterAlgoInput = await $("#flex2")
                    for(let i=0; i<savedFilterAlgo.length; i++) {
                        await filterAlgoInput.val(savedFilterAlgo[i])
                        let e = await $.Event("keyup",{keyCode:13})
                        await filterAlgoInput.trigger(e)
                        await filterAlgoInput.val("")
                    }
                })
                requestIsRunning = false
            } else if(status==='backUpData') {
                if(exportIntervalIsActive){
                    if(await ((new Date).getTime()-(exportIntervalStartDate.getTime())>3600000)){// 1hr
                        dataStatusPrio = true
                        dataStatusSpinnerHomeEl.show()
                        dataStatusEl
                            .empty()
                            .append(`<span style="white-space:nowrap;">Exporting data, please wait...</span>`)
                        await backUpData(data?.saveBackupDate??true)
                    }
                }
            } else {// Errors
                dataStatusEl
                    .empty()
                    .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                    .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                console.error(data.error)
                Swal.fire({
                    heightAuto: false,
                    text: data.error,
                    icon: "error",
                    confirmButtonColor: "#000"
                })
                requestIsRunning = false
            }
        }
        worker5.onerror = (error) => {
            worker5.terminate()
            for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
            dataStatusSpinnerHomeEl.hide()
            let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
            dataStatusEl
                .empty()
                .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
            console.error(error)
            Swal.fire({
                heightAuto: false,
                text: "Error 105: Oops...Something went wrong! Please try again...",
                icon: "error",
                confirmButtonColor: "#000"
            })
            requestIsRunning = false
        }
    }

    async function LoadData(){
        if(!isLoading) { isLoading = true }
        $("#first, #prev, #next, #last").addClass("disabled")
        await pageNumberOptionsEl.css('pointer-events','none')
        await animeTableEl.addClass("display-none")
        await tableSkeleton.removeClass("display-none")
        return await new Promise(async(resolve) => {
            if(haveSavedRecScheme) {
                let filters = await $("ul.flex0 > .value > .text").toArray()
                savedFilters = await filters.map((e)=>{
                    let filter = e.textContent.trim().toLowerCase()
                    if(filter==="hidden"){
                        hiddenUnhiddenBtnEl.text("Hidden")
                    } else {
                        hiddenUnhiddenBtnEl.text("Unhidden")
                    }
                    return filter
                }) || ["limit top wscore: 100", "!top similarities: !staffs", "!user status: !completed", "!user status: !dropped"]
                if(worker6) worker6.terminate()
                worker6 = new Worker(`./js-css/worker/loadData-${version}.js`)
                worker6.postMessage({
                    savedFilters: savedFilters
                })
                let animeData = ""
                worker6.onmessage = async ({data}) => {
                    animeData += data.chunk
                    if(data.done){
                        await animeRecommendationListEl.empty()
                        await animeRecommendationListEl.css({
                            "display":"none"
                        })
                        await animeRecommendationListEl.append(animeData)
                        await animeTableEl.trigger("update").trigger('pagerUpdate')
                        animeRecommendationListEl.css({
                            "display":""
                        })
                        await tableSkeleton.addClass("display-none")
                        await animeTableEl.removeClass("display-none")
                        // idk why savedUnhiddenTable Page sets to (page - 1) in SecondTolast and Last
                        if(savedTableStatus==="Unhidden"){
                            await animeTableEl.trigger("pageSet",(savedUnhiddenTablePage))
                        } else {
                            await animeTableEl.trigger("pageSet",(savedHiddenTablePage))
                        }
                        // Rename Pager Options Text
                        await pageNumberOptionsEl.find("option:selected").text(`${pageNumberOptionsEl.val()} of ${animeTableEl[0]?.config?.pager?.totalPages||1}`).prop('selected', true)
                        pageNumberOptionsEl.css('pointer-events','')
                        isLoading = false
                        resolve()
                    }
                }
                worker6.onerror = (error) => {
                    worker6.terminate()
                    pageNumberOptionsEl.css('pointer-events','')
                    tableSkeleton.addClass("display-none")
                    animeTableEl.removeClass("display-none")
                    console.error(error)
                    Swal.fire({
                        heightAuto: false,
                        text: "Error 108: Oops...Something went wrong! Please try again...",
                        icon: "error",
                        confirmButtonColor: "#000"
                    })
                    if(requestIsRunning){
                        for(let i=0;i<updateStateText.length;i++) clearTimeout(updateStateText[i])
                        dataStatusSpinnerHomeEl.hide()
                        let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                        dataStatusEl
                            .empty()
                            .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                            .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                        requestIsRunning = false
                    }
                    isLoading = false
                    resolve()
                }
            } else {
                pageNumberOptionsEl.css('pointer-events','')
                tableSkeleton.addClass("display-none")
                animeTableEl.removeClass("display-none")
                isLoading = false
                resolve()
            }
        })
    }

    async function backUpData(saveBackUpDate = true){
        return await new Promise(async(resolve)=>{
            if(worker7) worker7.terminate()
            worker7 = new Worker(`./js-css/worker/export-${version}.js`)
            // Android
            worker7.postMessage('android')
            let _data = ""
            // Android
            worker7.onmessage = async({data}) => {
                // Android
                _data += data.chunk
                // Android
                if(data.done){
                    // Android
                    await exportJsonData(_data, `Kanshi.${savedUsername.toLowerCase()||"Backup"}.json`)
                    // Android
                    if(saveBackUpDate){
                        exportIntervalStartDate = await new Date()
                        setTimeout(()=>{
                            saveJSON(exportIntervalStartDate, "exportIntervalStartDate")
                        },0)
                    }
                    dataStatusPrio = false
                    if(!requestIsRunning){
                        dataStatusSpinnerHomeEl.hide()
                        let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                        dataStatusEl
                            .empty()
                            .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                            .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                    }
                    if(!swal.isVisible()
                    &&!usernameEl.is(":focus")
                    &&!$("#flex0").is(":focus")
                    &&!$("#flex1").is(":focus")
                    &&!$("#flex2").is(":focus")
                    &&warnAnimeContainerEl.css("display")==="none"
                    &&filterAlgoContainerEl.css("display")==="none"){
                        await Swal.fire({
                            heightAuto: false,
                            text: "Data has been exported!",
                            icon: "success",
                            confirmButtonColor: "#000"
                        })
                    }
                    resolve()
                // Android
                }
                // Android
            }
            worker7.onerror = (error) => {
                worker7.terminate()
                console.error(error)
                dataStatusPrio = false
                if(!requestIsRunning){
                    dataStatusSpinnerHomeEl.hide()
                    let localeStr = new Date(lastSavedUpdateTime*1000).toLocaleString()
                    dataStatusEl
                        .empty()
                        .append(`<span style="white-space:nowrap;">${lastSavedUpdateTime?`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: `+localeStr:`<b class="${savedTheme}" id="dataStatusUpdate">⟳</b> Latest Anilist Update: N/A`}</span>`)
                        .attr("data-copy-value",`Latest Anilist Update: ${lastSavedUpdateTime?localeStr:'N/A'}`)
                }
                if(!swal.isVisible()
                 &&!usernameEl.is(":focus")
                 &&!$("#flex0").is(":focus")
                 &&!$("#flex1").is(":focus")
                 &&!$("#flex2").is(":focus")
                 &&warnAnimeContainerEl.css("display")==="none"
                 &&filterAlgoContainerEl.css("display")==="none"){
                    Swal.fire({
                        heightAuto: false,
                        text: "Error: Data was not exported, please try again",
                        icon: "error",
                        confirmButtonColor: "#000"
                    })
                }
                resolve()
            }
        })
    }

    function updateNotify(){
        let updateTime;
        if(haveSavedAnimeEntries){
            updateTime = arrayMean(savedAnalyzeVariableTime) + arrayMean(savedUpdateAnalyzeAnimeTime)
        } else {
            updateTime = arrayMean(savedDeepUpdateTime)
        }
        let newUsername = usernameEl.val()
        let isNewName = !equalsNCS(savedUsername,newUsername)
        if(requestIsRunning&&isNewName){
            text = `Username was changed from ${savedUsername} to ${newUsername},
            do you want to restart the update? This may take ${msToTime(updateTime*1000)} to finish.`
        } else if(isNewName){
            text = `Username was changed from ${savedUsername} to ${newUsername},
            do you want to continue the update? This may take ${msToTime(updateTime*1000)} to finish.`
        } else if(requestIsRunning){
            text = `Update is already running, do you want to restart the update?
            This may take ${msToTime(updateTime*1000)} to finish.`
        } else {
            text = `Do you want to continue the update?
            This may take ${msToTime(updateTime*1000)} to finish.`
        }
        Swal.fire({
            heightAuto: false,
            text: text,
            showConfirmButton: true,
            confirmButtonText: "Yes",
            showDenyButton: true,
            denyButtonText: "No",
            confirmButtonColor: '#000',
            denyButtonColor: '#e27d81',
            icon: "question",
            reverseButtons: true
        }).then((value)=>{
            if(value.isConfirmed){
                Update(true)
            }
        })
    }

    async function initUsernameData(){
        const { value: username } = await Swal.fire({
            heightAuto: false,
            title: "Starting Up",
            input: 'text',
            inputLabel: 'Enter your Anilist Username:',
            iconHtml: '<img src="./public/logo.png">',
            customClass: {
                icon: 'no-border'
            },
            allowOutsideClick: false,
            allowEscapeKey: false,
            showConfirmButton: true,
            confirmButtonText: "Search",
            confirmButtonColor: '#000',
            denyButtonColor: '#e27d81',
            reverseButtons: true,
            footer: `
                <a target="_blank" rel="noopener noreferrer" href="https://anilist.co/signup">Create an Anilist Account</a>
                <a href="javascript:;" onclick="$('#importBtn').click()">Import Backup</a>
            `,
            inputValidator: async(value) => {
                return await new Promise(async(resolve) => {
                    if(savedTheme==="darkMode"){
                        $(".swal2-validation-message").addClass('darkMode')
                    }
                    if(!value) {
                        resolve("You need to write Something...")
                    } else {
                        let UsernameValidationEl = await $("#UsernameValidation")
                        $.ajax({
                            type: 'POST',
                            url: 'https://graphql.anilist.co',
                            headers: {
                                'Content-Type': 'application/json',
                                'Accept': 'application/json',
                                'Cache-Control': 'max-age=31536000, immutable'
                            },
                            dataType: 'json',
                            data: JSON.stringify({
                                query: `{User(name:"${value}"){name}}`
                            }),
                            beforeSend: () => {
                                $(".swal2-validation-message")
                                    .addClass("no-before")
                                    .css({display:"flex"})
                                    .html(
                                        `<div id="UsernameValidation" style="display:flex; align-items:center; justify-content:center; ">
                                            <div><div style="margin-right:0.5ch;" class="dataStatusSpinner spinner ${savedTheme}"></div></div>
                                            <div>Checking Username...</div>
                                        </div>`
                                    )
                            },
                            success: (data) => {
                                initStartTime = undefined
                                setTimeout(()=>{
                                    saveJSON(initStartTime,"initStartTime")
                                },0)
                                UsernameValidationEl.fadeOut(1000,()=>{
                                    UsernameValidationEl.remove()
                                    $(".swal2-validation-message")
                                        .addClass("no-before").removeClass("no-before")
                                        .addClass("success-before")
                                        .html("User has been Found")
                                    setTimeout(()=>{
                                        // Reset Custom Validation
                                        filterAlgoValidationEl.html("").hide()
                                        resolve()
                                    },1000)
                                })
                            },
                            error: (xhr) =>{
                                if(!window.navigator.onLine){
                                    if((Math.floor(new Date()-initStartTime)>60000)||initStartTime===undefined){
                                        initStartTime = new Date()
                                        setTimeout(()=>{
                                            saveJSON(initStartTime,"initStartTime")
                                        },0)
                                    }
                                    UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                    resolve("Unable to connect to the Internet")
                                } else if(xhr?.responseJSON?.errors?.[0]?.message==='Not Found.'){
                                    initStartTime = undefined
                                    setTimeout(()=>{
                                        saveJSON(initStartTime,"initStartTime")
                                    },0)
                                    UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                    resolve("Username not Found, Please Try Again...")
                                } else {
                                    if((Math.floor(new Date()-initStartTime)>60000)||initStartTime===undefined){
                                        initStartTime = new Date()
                                        setTimeout(()=>{
                                            saveJSON(initStartTime,"initStartTime")
                                        },0)
                                    }
                                    UsernameValidationEl.fadeOut(1000,()=>$(this).remove())
                                    resolve(`An Error Occured, Please Try Again in ${msToTime(Math.max(60000-(new Date()-initStartTime),1000))}`)
                                }
                            }
                        })
                    }
                })
            }
        })
        filterAlgoValidationEl.html("").hide()
        if(username){
            await usernameEl.val(username)
            if(await !usernameEl?.val()??true){
                await $("#username").val(username)
                document.getElementById("username").value = await username
            }
            Update(true)
        }
    }

    function malanilistImportExport(){
        Swal.fire({
            heightAuto: false,
            title: "Transfer MAL to Anilist",
            icon: "info",
            text: `In order to transfer your MAL list to Anilist, you first need to export your list from MAL (e.g, xml file or extract the zip file first) and import the exported MAL file to your Anilist account, click a button below to continue.`,
            showConfirmButton: true,
            denyButtonText: "Export MAL",
            denyButtonColor: '#2E51A2',
            showDenyButton: true,
            confirmButtonText: "Import to Anilist",
            confirmButtonColor: "#000",
            showCancelButton: true,
            cancelButtonText: "Cancel",
            cancelButtonColor: "#e27d81",
            allowOutsideClick: false,
            allowEscapeKey: false,
            reverseButtons: true,
            footer: `<a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=eWooqnJ87-0">Watch this video for tutorial</a>
                        <a target="_blank" rel="noopener noreferrer" href="https://www.youtube.com/watch?v=rfHTiT_7a4U">Auto sync MAL and Anilist</a>`
        }).then(async(value) => {
            if(value.isConfirmed){
                await window.open('https://anilist.co/settings/import', '_blank');
                malanilistImportExport()
            } else if(value.isDenied) {
                await window.open('https://myanimelist.net/panel.php?go=export', '_blank');
                malanilistImportExport()
            }
        })
    }

    async function loadTheme(newTheme,prevTheme){
        return await new Promise(async(resolve)=>{
            let allElement = await $(`
                    html,
                    body,
                    #nav,
                    #Home,
                    #searchData,
                    button,
                    #overlay,
                    #username,
                    #dataStatusHolder,
                    #dataStatusUpdate,
                    .flexdatalist-multiple,
                    .flexdatalist-alias,
                    .flexdatalist-results,
                    .flexdatalist-multiple > .value,
                    #anime-table,
                    #anime-table thead,
                    #anime-table tr,
                    #anime-table th,
                    #animeRecommendationList,
                    #animeRecommendationList tr,
                    #animeRecommendationList td,
                    .td-container,
                    #animeRecommendationList a,
                    #pager,
                    #pageNumberOptions,
                    #pageNumberOptions>option.darkMode,
                    #table-skeleton,
                    #table-skeleton tr,
                    #table-skeleton th,
                    #table-skeleton td,
                    #table-skeleton span,
                    .swal2-popup,
                    .swal2-popup-custom,
                    .swal2-validation-message,
                    .swal2-footer > a,
                    .swal2-confirm,
                    .swal2-confirm-custom,
                    .spinner
                `)
            // Remove default
            if(newTheme!=="dakMode"&&!prevTheme){
                await allElement.removeClass("darkMode")
            }
            // Remove Previous
            if(prevTheme){
                await allElement.removeClass(prevTheme)
            }
            // Apply New
            await allElement.addClass(newTheme)
            resolve()
        })
    }

    // Helper Function
    async function IDBinit(){
        return await new Promise((resolve)=>{
            request = indexedDB.open("Kanshi.Anime.Recommendations.Anilist.W~uPtWCq=vG$TR:Zl^#t<vdS]I~N70", 1)
            request.onerror = (error) => {
                Swal.fire({
                    heightAuto: false,
                    title: "Oops, heh",
                    text: "Your browser is not supported, to continue please update to recent version, use non private/incognito, or use another browser.",
                    imageUrl: './public/anya-smile.gif',
                    imageAlt: 'Custom image',
                    confirmButtonColor: "#000",
                    background: "#0b1622",
                    color: "#b9cadd",
                    confirmButtonColor: "#284566",
                    allowOutsideClick: false,
                    allowEscapeKey: false,
                    customClass: {
                        container: 'topOfLoader',
                    }
                }).then(()=>{
                    window.location.href = window.location.href
                })
                loadTheme("darkMode")
                console.error(error)
            }
            request.onsuccess = (event) => {
                db = event.target.result
                resolve()
            }
            request.onupgradeneeded = (event) => {
                db = event.target.result;
                db.createObjectStore("MyObjectStore")
                resolve()
            }
        })
    }
    async function saveJSON(data, name) {
        return new Promise(async(resolve)=>{
            try {
                let write = db.transaction("MyObjectStore","readwrite").objectStore("MyObjectStore").openCursor()
                write.onsuccess = async(event) => {
                    const cursor = event.target.result;
                    if (cursor) {
                        if(cursor.key===name){
                            await cursor.update(data)
                            resolve()
                        }
                        await cursor.continue()
                    } else {
                        await db.transaction("MyObjectStore","readwrite").objectStore("MyObjectStore").add(data, name)
                        resolve()
                    }
                }
                write.onerror = async(error) => {
                    console.error(error)
                    await db.transaction("MyObjectStore","readwrite").objectStore("MyObjectStore").add(data, name)
                    resolve()
                }
            } catch(ex) {
                try{
                    console.error(ex)
                    await db.transaction("MyObjectStore","readwrite").objectStore("MyObjectStore").add(data, name)
                    resolve()
                } catch(ex2) {
                    console.error(ex2)
                    resolve()
                }
            }
        })
    }
    async function retrieveJSON(name) {
        return new Promise((resolve)=>{
            try {
                let read = db.transaction("MyObjectStore","readwrite").objectStore("MyObjectStore").get(name)
                read.onsuccess = (event) => {
                    resolve(read.result)
                }
                read.onerror = (error) => {
                    console.error(error)
                    resolve()
                }
            } catch(ex){
                console.error(ex)
                resolve()
            }
        })
    }
    async function deleteJSON(name) {
        return new Promise((resolve)=>{
            try {
                let read = db.transaction("MyObjectStore","readwrite").objectStore("MyObjectStore").delete(name)
                read.onsuccess = (event) => {
                    resolve()
                }
                read.onerror = (error) => {
                    console.error(error)
                    resolve()
                }
            } catch(ex) {
                console.error(ex)
                resolve()
            }
        })
    }
    function equalsNCS(str1, str2) {
        let s1 = str1
        let s2 = str2
        if(typeof s1==="number") s1 = s1.toString()
        if(typeof s2==="number") s2 = s2.toString()
        if(typeof s1==="string") s1 = s1.trim().toLowerCase()
        if(typeof s2==="string") s2 = s2.trim().toLowerCase()
        return s1 === s2
    }
    function isJson(j){
        try{return(j?.constructor.name==='Object'&&`${j}`==='[object Object]')}
        catch(e){return false}
    }
    function jsonIsEmpty(obj){
        if(isJson(obj)){
            for(let i in obj) return false
            return true
        }
        console.error(`Error: Expected Object Constructor (reading '${obj?.constructor.name}' - ${JSON.stringify(obj)})`)
        return true // Temporarily Added for Past Conditions to Work
    }
    // async function isJsonString(str) {
    //     try {return isJson(await parseJson(str));}
    //     catch (e) {return false;}
    //     return true;
    // }
    function isInt(num) {
        if (isNaN(num)) return false;
        x = parseFloat(num);
        return (x | 0) === x;
    }
    function arraySum(obj) {
        return obj.reduce((a, b) => a + b, 0)
    }
    function arrayMean(obj) {
        return (arraySum(obj) / obj.length) || 0
    }
    function msToTime(duration) {
        let seconds = Math.floor((duration / 1000) % 60),
            minutes = Math.floor((duration / (1000*60)) % 60),
            hours = Math.floor((duration / (1000*60*60)) % 24),
            days = Math.floor((duration / (1000*60*60*24)) % 7),
            weeks = Math.floor((duration / (1000*60*60*24*7)) % 4),
            months = Math.floor((duration / (1000*60*60*24*7*4)) % 12)
            years = Math.floor((duration / (1000*60*60*24*7*4*12)) % 10)
            decades = Math.floor((duration / (1000*60*60*24*7*4*12*10)) % 10)
            century = Math.floor((duration / (1000*60*60*24*7*4*12*10*10)) % 10)
            millenium = Math.floor((duration / (1000*60*60*24*7*4*12*10*10*10)) % 10)
        let time = []
        if(millenium<=0&&century<=0&&decades<=0&&years<=0&&months<=0&&weeks<=0&&days<=0&&hours<=0&&minutes<=0&&seconds<=0) return "0s"
        if(millenium>0) time.push(millenium===1?`${millenium}mil`:`${millenium}mils`)
        if(decades>0) time.push(decades===1?`${decades}de`:`${decades}des`)
        if(years>0) time.push(`${years}y`)
        if(months>0) time.push(months===1?`${months}mo`:`${months}mos`)
        if(weeks>0) time.push(`${weeks}w`)
        if(days>0) time.push(`${days}d`)
        if(hours>0) time.push(`${hours}h`)
        if(minutes>0) time.push(`${minutes}m`)
        if(seconds>0) time.push(`${seconds}s`)
        return time.join(" ")
    }
    // Android
    function exportJsonData(objStr, fileName) {
        JSBridge.exportJSON(objStr, fileName);
    }
    function copyToClipBoard(text) {
        JSBridge.copyToClipBoard(text);
    }
    // Android
    // Debug
    // let fpsMean = []
    // let fps = document.getElementById("fps");
    // let startTime = Date.now();
    // let frame = 0;
    // function tick() {
    //   let time = Date.now();
    //   frame++;
    //   if (time - startTime > 1000) {
    //     let f = (frame / ((time - startTime) / 1000));
    //     if(fpsMean.length<1000){
    //         fpsMean.push(f)
    //     } else {
    //         fpsMean.shift()
    //         fpsMean.push(f)
    //     }
    //     fps.innerHTML = arrayMean(fpsMean).toFixed(1)
    //     startTime = time;
    //     frame = 0;
    //   }
    //   window.requestAnimationFrame(tick);
    // }
    // tick();
    // Debug
    </script>
</body>
</html>